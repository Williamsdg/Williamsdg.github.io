<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>Mudtown Eat & Drink | Staff Portal</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700;800&family=Playfair+Display:wght@700;800&display=swap" rel="stylesheet">
    <style>
        *,*::before,*::after{margin:0;padding:0;box-sizing:border-box}
        :root{
            --ink:#1a1a1a;--cream:#faf7f2;--warm:#f5efe6;--tan:#e8ddd0;
            --rust:#c4582a;--rust-dark:#9e3f18;--rust-light:#fdf0ea;--gold:#d4a847;--gold-light:#fdf8ec;
            --sage:#5a6e4e;--sage-light:#f0f4ed;
            --white:#fff;--g50:#f9f8f6;--g100:#f1f0ee;--g200:#ddd9d3;--g300:#c5c0b8;--g400:#999590;--g500:#6b6660;--g600:#4a4640;--g700:#333;--g800:#222;--g900:#1a1a1a;
            --green:#16a34a;--green-l:#dcfce7;--orange:#f97316;--orange-l:#fff7ed;--red:#ef4444;--red-l:#fef2f2;--blue:#2563eb;--blue-l:#eff6ff;
            --r:12px;--shadow:0 1px 3px rgba(0,0,0,0.06),0 4px 12px rgba(0,0,0,0.04)
        }
        html{scroll-behavior:smooth}
        body{font-family:'DM Sans',system-ui,sans-serif;background:var(--cream);color:var(--ink);line-height:1.5;min-height:100vh}
        .serif{font-family:'Playfair Display',Georgia,serif}

        /* SIDEBAR */
        .sidebar{width:260px;background:var(--ink);color:var(--white);position:fixed;top:0;left:0;bottom:0;display:flex;flex-direction:column;z-index:50;transition:transform .3s}
        .sidebar-header{padding:24px 24px 20px;border-bottom:1px solid rgba(255,255,255,0.08)}
        .sidebar-logo{font-family:'Playfair Display',serif;font-size:1.15rem;font-weight:800;color:var(--white)}
        .sidebar-logo span{color:var(--gold)}
        .sidebar-sub{font-size:.65rem;color:var(--g400);text-transform:uppercase;letter-spacing:2px;margin-top:4px}
        .sidebar-nav{flex:1;padding:16px 12px;display:flex;flex-direction:column;gap:2px;overflow-y:auto}
        .nav-section{font-size:.6rem;font-weight:700;color:var(--g500);text-transform:uppercase;letter-spacing:2px;padding:16px 16px 6px}
        .nav-item{display:flex;align-items:center;gap:12px;padding:10px 16px;border-radius:10px;color:var(--g400);text-decoration:none;font-size:.875rem;font-weight:500;transition:all .2s;cursor:pointer;border:none;background:none;width:100%;text-align:left}
        .nav-item:hover{background:rgba(255,255,255,0.06);color:var(--white)}
        .nav-item.active{background:rgba(196,88,42,0.2);color:var(--gold)}
        .nav-item svg{width:18px;height:18px;flex-shrink:0}
        .nav-badge{margin-left:auto;background:var(--rust);color:var(--white);font-size:.65rem;font-weight:700;padding:2px 7px;border-radius:50px}
        .sidebar-footer{padding:16px 24px;border-top:1px solid rgba(255,255,255,0.06);font-size:.7rem;color:var(--g500)}

        /* MAIN */
        .main{margin-left:260px;flex:1}
        .topbar{background:var(--white);border-bottom:1px solid var(--g200);padding:14px 32px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:40}
        .topbar h1{font-family:'Playfair Display',serif;font-size:1.15rem;font-weight:800;color:var(--ink)}
        .topbar-right{display:flex;align-items:center;gap:14px}
        .avatar{width:34px;height:34px;border-radius:50%;background:var(--rust);color:var(--white);display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.8rem}
        .content{padding:28px 32px}

        /* CARDS */
        .card{background:var(--white);border-radius:14px;box-shadow:var(--shadow);overflow:hidden}
        .card-header{padding:18px 24px;border-bottom:1px solid var(--g100);display:flex;align-items:center;justify-content:space-between}
        .card-header h2{font-family:'Playfair Display',serif;font-size:1rem;font-weight:800;color:var(--ink)}
        .card-body{padding:24px}

        /* STATS */
        .stats-row{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;margin-bottom:24px}
        .stat-card{background:var(--white);border-radius:var(--r);padding:18px 20px;box-shadow:var(--shadow)}
        .stat-icon{width:38px;height:38px;border-radius:10px;display:flex;align-items:center;justify-content:center;margin-bottom:10px}
        .stat-icon svg{width:18px;height:18px}
        .stat-label{font-size:.72rem;font-weight:600;color:var(--g500);text-transform:uppercase;letter-spacing:.5px}
        .stat-value{font-family:'Playfair Display',serif;font-size:1.5rem;font-weight:800;color:var(--ink);margin-top:2px}
        .stat-sub{font-size:.75rem;color:var(--g400);margin-top:2px}

        /* FORMS */
        .form-group{margin-bottom:16px}
        .form-group label{display:block;font-size:.8rem;font-weight:600;color:var(--g600);margin-bottom:5px}
        .form-group input,.form-group select,.form-group textarea{width:100%;padding:9px 13px;border:1.5px solid var(--g200);border-radius:9px;font-size:.875rem;font-family:inherit;color:var(--ink);background:var(--white);transition:border-color .2s,box-shadow .2s}
        .form-group input:focus,.form-group select:focus,.form-group textarea:focus{outline:none;border-color:var(--rust);box-shadow:0 0 0 3px rgba(196,88,42,0.1)}
        .form-group textarea{resize:vertical;min-height:70px}
        .form-row{display:grid;grid-template-columns:1fr 1fr;gap:14px}
        .form-row-3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:14px}
        .form-row-4{display:grid;grid-template-columns:1fr 1fr 1fr 1fr;gap:14px}

        /* BUTTONS */
        .btn{display:inline-flex;align-items:center;gap:7px;padding:9px 18px;border-radius:9px;font-weight:600;font-size:.85rem;font-family:inherit;text-decoration:none;transition:all .2s;cursor:pointer;border:none}
        .btn-rust{background:var(--rust);color:var(--white)}.btn-rust:hover{background:var(--rust-dark)}
        .btn-gold{background:var(--gold);color:var(--ink)}.btn-gold:hover{filter:brightness(0.9)}
        .btn-green{background:var(--green);color:var(--white)}.btn-green:hover{filter:brightness(0.9)}
        .btn-outline{background:transparent;color:var(--g600);border:1.5px solid var(--g200)}.btn-outline:hover{border-color:var(--rust);color:var(--rust)}
        .btn-sm{padding:6px 12px;font-size:.78rem;border-radius:7px}
        .btn-group{display:flex;gap:8px}

        /* TABLES */
        table{width:100%;border-collapse:collapse}
        th{text-align:left;padding:10px 16px;font-size:.7rem;font-weight:600;color:var(--g500);text-transform:uppercase;letter-spacing:.5px;border-bottom:1px solid var(--g100);background:var(--g50)}
        td{padding:12px 16px;font-size:.875rem;border-bottom:1px solid var(--g100);vertical-align:middle}
        tr:hover td{background:var(--g50)}

        /* BADGES */
        .badge{display:inline-block;padding:3px 10px;border-radius:50px;font-size:.7rem;font-weight:600;white-space:nowrap}
        .badge-scheduled{background:var(--rust-light);color:var(--rust)}
        .badge-confirmed{background:var(--green-l);color:var(--green)}
        .badge-pending{background:var(--orange-l);color:var(--orange)}
        .badge-active{background:var(--green-l);color:var(--green)}
        .badge-off{background:var(--g100);color:var(--g500)}
        .badge-low{background:var(--red-l);color:var(--red)}
        .badge-ok{background:var(--green-l);color:var(--green)}
        .badge-ordered{background:var(--blue-l);color:var(--blue)}
        .badge-pinned{background:var(--gold-light);color:var(--gold)}

        /* PAGES */
        .page{display:none}.page.active{display:block}

        /* MODALS */
        .modal-overlay{display:none;position:fixed;inset:0;z-index:100;background:rgba(0,0,0,0.4);backdrop-filter:blur(4px);align-items:center;justify-content:center;padding:24px}
        .modal-overlay.open{display:flex}
        .modal{background:var(--white);border-radius:16px;box-shadow:0 8px 32px rgba(0,0,0,0.12);width:100%;max-width:680px;max-height:90vh;overflow-y:auto}
        .modal-lg{max-width:780px}
        .modal-header{padding:18px 24px;border-bottom:1px solid var(--g100);display:flex;align-items:center;justify-content:space-between}
        .modal-header h2{font-family:'Playfair Display',serif;font-size:1.05rem;font-weight:800;color:var(--ink)}
        .modal-close{background:none;border:none;font-size:1.5rem;cursor:pointer;color:var(--g400);line-height:1}
        .modal-body{padding:24px}
        .modal-footer{padding:14px 24px;border-top:1px solid var(--g100);display:flex;justify-content:flex-end;gap:10px}

        /* SCHEDULE GRID */
        .sched-grid{display:grid;grid-template-columns:60px repeat(7,1fr);gap:1px;background:var(--g200);border-radius:var(--r);overflow:hidden;margin-bottom:24px}
        .sched-header{background:var(--ink);color:var(--white);padding:10px 8px;font-size:.72rem;font-weight:700;text-align:center;text-transform:uppercase;letter-spacing:.5px}
        .sched-time{background:var(--warm);padding:8px;font-size:.72rem;font-weight:600;color:var(--g600);text-align:center;display:flex;align-items:center;justify-content:center}
        .sched-cell{background:var(--white);padding:4px;min-height:48px;position:relative}
        .sched-chip{font-size:.65rem;font-weight:600;padding:3px 6px;border-radius:5px;margin:1px;display:block;line-height:1.3;cursor:default}
        .chip-host{background:#ede9fe;color:#7c3aed}
        .chip-server{background:var(--rust-light);color:var(--rust)}
        .chip-kitchen{background:var(--sage-light);color:var(--sage)}
        .chip-bar{background:var(--gold-light);color:#92700e}
        .chip-bus{background:var(--blue-l);color:var(--blue)}

        /* CHAT */
        .chat-container{display:flex;flex-direction:column;height:520px}
        .chat-messages{flex:1;overflow-y:auto;padding:20px;display:flex;flex-direction:column;gap:12px}
        .chat-msg{display:flex;gap:10px;max-width:85%}
        .chat-msg.own{align-self:flex-end;flex-direction:row-reverse}
        .chat-avatar{width:32px;height:32px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-weight:700;font-size:.7rem;flex-shrink:0;color:var(--white)}
        .chat-bubble{padding:10px 14px;border-radius:12px;font-size:.875rem;line-height:1.5}
        .chat-msg:not(.own) .chat-bubble{background:var(--g100);color:var(--ink);border-bottom-left-radius:4px}
        .chat-msg.own .chat-bubble{background:var(--rust);color:var(--white);border-bottom-right-radius:4px}
        .chat-name{font-size:.7rem;font-weight:700;color:var(--g500);margin-bottom:2px}
        .chat-time{font-size:.65rem;color:var(--g400);margin-top:3px}
        .chat-input-row{display:flex;gap:10px;padding:16px 20px;border-top:1px solid var(--g100);background:var(--g50)}
        .chat-input-row input{flex:1;padding:10px 14px;border:1.5px solid var(--g200);border-radius:50px;font-size:.875rem;font-family:inherit}
        .chat-input-row input:focus{outline:none;border-color:var(--rust)}
        .chat-channel{display:flex;gap:6px;padding:12px 20px;border-bottom:1px solid var(--g100);overflow-x:auto}
        .channel-btn{padding:6px 14px;border-radius:50px;font-size:.78rem;font-weight:600;border:1.5px solid var(--g200);background:var(--white);color:var(--g600);cursor:pointer;white-space:nowrap;transition:all .2s;font-family:inherit}
        .channel-btn.active{background:var(--ink);border-color:var(--ink);color:var(--white)}

        /* INVENTORY */
        .inv-status{display:flex;align-items:center;gap:8px}
        .inv-bar{width:80px;height:6px;border-radius:3px;background:var(--g200);overflow:hidden}
        .inv-fill{height:100%;border-radius:3px}

        /* CATERING ESTIMATE PREVIEW */
        .ep-header{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:24px;padding-bottom:16px;border-bottom:2px solid var(--ink)}
        .ep-company h3{font-family:'Playfair Display',serif;font-size:1.1rem;font-weight:800;color:var(--ink)}
        .ep-company p{font-size:.8rem;color:var(--g500)}
        .ep-est-num{text-align:right}
        .ep-est-num h4{font-size:.85rem;font-weight:700;color:var(--ink);text-transform:uppercase;letter-spacing:1px}
        .ep-est-num p{font-size:.85rem;color:var(--g500)}
        .ep-parties{display:grid;grid-template-columns:1fr 1fr;gap:24px;margin-bottom:24px}
        .ep-parties h5{font-size:.7rem;font-weight:700;color:var(--g400);text-transform:uppercase;letter-spacing:1px;margin-bottom:4px}
        .ep-parties p{font-size:.875rem;color:var(--g600)}
        .ep-table{width:100%;border-collapse:collapse;margin-bottom:16px}
        .ep-table th{background:var(--ink);color:var(--white);padding:10px 14px;font-size:.7rem;text-transform:uppercase;letter-spacing:.5px;text-align:left}
        .ep-table td{padding:10px 14px;font-size:.875rem;border-bottom:1px solid var(--g100)}
        .ep-table .right{text-align:right}
        .ep-totals{text-align:right;margin-top:8px}
        .ep-totals .line{display:flex;justify-content:flex-end;gap:32px;padding:4px 0;font-size:.875rem;color:var(--g600)}
        .ep-totals .line.total{font-weight:800;font-size:1.05rem;color:var(--ink);border-top:2px solid var(--g200);padding-top:8px;margin-top:4px}
        .estimate-preview{border:1.5px solid var(--g200);border-radius:var(--r);padding:28px;background:var(--white);margin-top:16px}

        /* TOAST */
        .toast{position:fixed;bottom:32px;right:32px;z-index:200;background:var(--ink);color:var(--white);padding:14px 24px;border-radius:var(--r);font-size:.875rem;font-weight:500;box-shadow:0 8px 32px rgba(0,0,0,0.15);transform:translateY(100px);opacity:0;transition:all .3s}
        .toast.show{transform:translateY(0);opacity:1}.toast.success{background:var(--green)}

        /* TABS */
        .tabs{display:flex;gap:4px;margin-bottom:20px}
        .tab{padding:8px 16px;font-size:.85rem;font-weight:600;color:var(--g400);cursor:pointer;border:none;background:none;border-bottom:2px solid transparent;transition:all .2s;font-family:inherit}
        .tab.active{color:var(--rust);border-bottom-color:var(--rust)}

        /* INFO BOX */
        .info-box{background:var(--rust-light);border-radius:10px;padding:14px 18px;margin-top:12px}
        .info-box p{font-size:.8rem;color:var(--g600)}
        .info-box strong{color:var(--rust)}

        /* RESPONSIVE */
        .sidebar-toggle{display:none;background:none;border:none;cursor:pointer;padding:4px}
        .sidebar-toggle svg{width:24px;height:24px;color:var(--ink)}
        .sidebar-close{display:none;position:absolute;top:16px;right:16px;background:none;border:none;color:var(--g400);font-size:1.5rem;cursor:pointer}
        @media(max-width:1024px){.stats-row{grid-template-columns:repeat(2,1fr)}.form-row-3,.form-row-4{grid-template-columns:1fr 1fr}.sched-grid{font-size:.65rem}}
        @media(max-width:768px){.sidebar{transform:translateX(-100%)}.sidebar.open{transform:translateX(0)}.sidebar-close,.sidebar-toggle{display:block}.main{margin-left:0}.content{padding:20px}.topbar{padding:14px 20px}.stats-row{grid-template-columns:1fr}.form-row,.form-row-3,.form-row-4{grid-template-columns:1fr}.sched-grid{display:none}}
    </style>
</head>
<body>
<aside class="sidebar" id="sidebar">
    <button class="sidebar-close" onclick="document.getElementById('sidebar').classList.remove('open')">&times;</button>
    <div class="sidebar-header">
        <div class="sidebar-logo">Mud<span>town</span></div>
        <div class="sidebar-sub">Staff Portal</div>
    </div>
    <nav class="sidebar-nav">
        <div class="nav-section">Overview</div>
        <button class="nav-item active" onclick="switchPage('dashboard',this)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7" rx="1"/><rect x="14" y="3" width="7" height="7" rx="1"/><rect x="3" y="14" width="7" height="7" rx="1"/><rect x="14" y="14" width="7" height="7" rx="1"/></svg>Dashboard</button>

        <div class="nav-section">Operations</div>
        <button class="nav-item" onclick="switchPage('specials',this)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>Daily Specials</button>
        <button class="nav-item" onclick="switchPage('scheduling',this)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></svg>Staff Scheduling</button>
        <button class="nav-item" onclick="switchPage('availability',this)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>Availability</button>
        <button class="nav-item" onclick="switchPage('handoff',this)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><path d="M14 2v6h6"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><line x1="10" y1="9" x2="8" y2="9"/></svg>Shift Notes<span class="nav-badge">2</span></button>
        <button class="nav-item" onclick="switchPage('inventory',this)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/><polyline points="3.27 6.96 12 12.01 20.73 6.96"/><line x1="12" y1="22.08" x2="12" y2="12"/></svg>Inventory & Orders<span class="nav-badge">3</span></button>
        <button class="nav-item" onclick="switchPage('catering',this)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>Catering Estimates</button>

        <div class="nav-section">Finance</div>
        <button class="nav-item" onclick="switchPage('sales',this)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="20" x2="18" y2="10"/><line x1="12" y1="20" x2="12" y2="4"/><line x1="6" y1="20" x2="6" y2="14"/></svg>Sales Dashboard</button>
        <button class="nav-item" onclick="switchPage('costing',this)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>Menu Costing</button>

        <div class="nav-section">Communication</div>
        <button class="nav-item" onclick="switchPage('chat',this)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>Team Chat<span class="nav-badge">5</span></button>

        <div class="nav-section">Admin</div>
        <button class="nav-item" onclick="switchPage('team',this)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>Team Members</button>
        <button class="nav-item" onclick="switchPage('safety',this)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>Health & Safety</button>
        <button class="nav-item" onclick="switchPage('docs',this)"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"/><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"/></svg>Documents</button>
    </nav>
    <div class="sidebar-footer">&copy; 2026 Mudtown Eat &amp; Drink<br>Powered by Williams Digital</div>
</aside>

<div class="main">
    <div class="topbar">
        <div style="display:flex;align-items:center;gap:12px">
            <button class="sidebar-toggle" onclick="document.getElementById('sidebar').classList.toggle('open')"><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button>
            <h1 id="pageTitle">Dashboard</h1>
        </div>
        <div class="topbar-right">
            <span style="font-size:.8rem;color:var(--g500)">Owner</span>
            <div class="avatar">MT</div>
        </div>
    </div>

    <div class="content">
        <!-- ===== DASHBOARD ===== -->
        <div class="page active" id="page-dashboard">
            <div class="stats-row">
                <div class="stat-card">
                    <div class="stat-icon" style="background:var(--rust-light)"><svg viewBox="0 0 24 24" fill="none" stroke="#c4582a" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/></svg></div>
                    <div class="stat-label">On Shift Today</div><div class="stat-value">8</div><div class="stat-sub">of 14 staff</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background:var(--gold-light)"><svg viewBox="0 0 24 24" fill="none" stroke="#92700e" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg></div>
                    <div class="stat-label">Catering Pending</div><div class="stat-value">$4,200</div><div class="stat-sub">2 estimates out</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background:var(--red-l)"><svg viewBox="0 0 24 24" fill="none" stroke="#ef4444" stroke-width="2"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg></div>
                    <div class="stat-label">Low Stock Items</div><div class="stat-value">3</div><div class="stat-sub">Need reorder</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon" style="background:var(--sage-light)"><svg viewBox="0 0 24 24" fill="none" stroke="#5a6e4e" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg></div>
                    <div class="stat-label">Unread Messages</div><div class="stat-value">5</div><div class="stat-sub">In team chat</div>
                </div>
            </div>

            <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:24px">
                <div class="card">
                    <div class="card-header"><h2>Today's Shifts</h2></div>
                    <div class="card-body" style="padding:16px">
                        <div style="display:flex;flex-direction:column;gap:8px" id="dashShifts"></div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header"><h2>Low Stock Alerts</h2></div>
                    <table><thead><tr><th>Item</th><th>Stock</th><th>Status</th></tr></thead>
                    <tbody id="dashLowStock"></tbody></table>
                </div>
            </div>
            <div class="card">
                <div class="card-header"><h2>Recent Team Messages</h2></div>
                <div class="card-body" id="dashMessages" style="padding:16px"></div>
            </div>
        </div>

        <!-- ===== STAFF SCHEDULING ===== -->
        <div class="page" id="page-scheduling">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
                <div style="display:flex;align-items:center;gap:12px">
                    <button class="btn btn-outline btn-sm" onclick="changeWeek(-1)">&larr; Prev</button>
                    <span style="font-weight:700;color:var(--ink)" id="weekLabel">This Week</span>
                    <button class="btn btn-outline btn-sm" onclick="changeWeek(1)">Next &rarr;</button>
                </div>
                <button class="btn btn-rust" onclick="openModal('shiftModal')">+ Add Shift</button>
            </div>

            <div style="display:flex;gap:8px;margin-bottom:16px;flex-wrap:wrap">
                <span class="sched-chip chip-host" style="padding:4px 10px;border-radius:6px;font-size:.75rem">Host</span>
                <span class="sched-chip chip-server" style="padding:4px 10px;border-radius:6px;font-size:.75rem">Server</span>
                <span class="sched-chip chip-kitchen" style="padding:4px 10px;border-radius:6px;font-size:.75rem">Kitchen</span>
                <span class="sched-chip chip-bar" style="padding:4px 10px;border-radius:6px;font-size:.75rem">Bar</span>
                <span class="sched-chip chip-bus" style="padding:4px 10px;border-radius:6px;font-size:.75rem">Busser</span>
            </div>

            <div class="sched-grid" id="schedGrid"></div>

            <div class="card">
                <div class="card-header"><h2>All Scheduled Shifts</h2></div>
                <table><thead><tr><th>Date</th><th>Time</th><th>Role</th><th>Staff</th><th>Status</th><th></th></tr></thead>
                <tbody id="shiftTableBody"></tbody></table>
            </div>
        </div>

        <!-- ===== INVENTORY & ORDERS ===== -->
        <div class="page" id="page-inventory">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
                <div class="tabs">
                    <button class="tab active" onclick="switchInvTab('stock',this)">Current Stock</button>
                    <button class="tab" onclick="switchInvTab('orders',this)">Purchase Orders</button>
                    <button class="tab" onclick="switchInvTab('vendors',this)">Vendors</button>
                </div>
                <button class="btn btn-rust" onclick="openModal('orderModal')">+ New Order</button>
            </div>

            <div id="invTab-stock">
                <div class="card">
                    <table><thead><tr><th>Item</th><th>Category</th><th>In Stock</th><th>Par Level</th><th>Stock Level</th><th>Status</th><th></th></tr></thead>
                    <tbody id="stockTableBody"></tbody></table>
                </div>
            </div>
            <div id="invTab-orders" style="display:none">
                <div class="card">
                    <table><thead><tr><th>PO #</th><th>Vendor</th><th>Items</th><th>Total</th><th>Date</th><th>Status</th><th></th></tr></thead>
                    <tbody id="poTableBody"></tbody></table>
                </div>
            </div>
            <div id="invTab-vendors" style="display:none">
                <div class="card">
                    <table><thead><tr><th>Vendor</th><th>Category</th><th>Contact</th><th>Phone</th><th>Last Order</th></tr></thead>
                    <tbody>
                        <tr><td style="font-weight:600">Sysco Birmingham</td><td>Food & Supplies</td><td>Mike Reynolds</td><td>(205) 655-2800</td><td>Jan 27, 2026</td></tr>
                        <tr><td style="font-weight:600">US Foods</td><td>Food & Produce</td><td>Sarah Jenkins</td><td>(205) 477-3100</td><td>Jan 24, 2026</td></tr>
                        <tr><td style="font-weight:600">Birmingham Beverage</td><td>Beer & Wine</td><td>Tom Baker</td><td>(205) 322-4600</td><td>Jan 26, 2026</td></tr>
                        <tr><td style="font-weight:600">Republic National</td><td>Spirits & Liquor</td><td>James Moore</td><td>(205) 945-1200</td><td>Jan 20, 2026</td></tr>
                        <tr><td style="font-weight:600">Flowers Foods</td><td>Bread & Bakery</td><td>Linda Davis</td><td>(205) 338-7700</td><td>Jan 28, 2026</td></tr>
                        <tr><td style="font-weight:600">Cahaba Produce</td><td>Fresh Produce</td><td>Roberto Alvarez</td><td>(205) 591-4500</td><td>Jan 29, 2026</td></tr>
                    </tbody></table>
                </div>
            </div>
        </div>

        <!-- ===== CATERING ESTIMATES ===== -->
        <div class="page" id="page-catering">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
                <div></div>
                <button class="btn btn-rust" onclick="openModal('cateringModal')">+ New Catering Estimate</button>
            </div>
            <div class="card">
                <table><thead><tr><th>#</th><th>Client</th><th>Event</th><th>Date</th><th>Guests</th><th>Amount</th><th>Status</th><th></th></tr></thead>
                <tbody id="cateringTableBody"></tbody></table>
            </div>
            <div id="cateringPreviewArea" style="margin-top:24px;display:none"></div>
        </div>

        <!-- ===== TEAM CHAT ===== -->
        <div class="page" id="page-chat">
            <div class="card">
                <div class="chat-channel">
                    <button class="channel-btn active" onclick="switchChannel('general',this)"># General</button>
                    <button class="channel-btn" onclick="switchChannel('kitchen',this)"># Kitchen</button>
                    <button class="channel-btn" onclick="switchChannel('front',this)"># Front of House</button>
                    <button class="channel-btn" onclick="switchChannel('menu',this)"># Menu Ideas</button>
                    <button class="channel-btn" onclick="switchChannel('announce',this)"># Announcements</button>
                </div>
                <div class="chat-container">
                    <div class="chat-messages" id="chatMessages"></div>
                    <div class="chat-input-row">
                        <input type="text" id="chatInput" placeholder="Type a message..." onkeydown="if(event.key==='Enter')sendChat()">
                        <button class="btn btn-rust btn-sm" onclick="sendChat()">Send</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== DAILY SPECIALS ===== -->
        <div class="page" id="page-specials">
            <div class="card" style="margin-bottom:20px">
                <div class="card-header"><h2>Today's Specials & 86'd Items</h2><span style="font-size:.8rem;color:var(--g400)" id="specialsDate"></span></div>
                <div class="card-body">
                    <div style="display:grid;grid-template-columns:1fr 1fr;gap:24px">
                        <div>
                            <h3 style="font-size:.85rem;font-weight:700;color:var(--sage);text-transform:uppercase;letter-spacing:1px;margin-bottom:12px">Today's Specials</h3>
                            <div id="specialsList" style="display:flex;flex-direction:column;gap:8px"></div>
                            <div style="margin-top:16px;padding-top:16px;border-top:1px solid var(--g100)">
                                <div class="form-row" style="margin-bottom:8px"><div class="form-group" style="margin:0"><input type="text" id="newSpecialName" placeholder="Item name (e.g. Blackened Catfish)"></div><div class="form-group" style="margin:0"><input type="text" id="newSpecialPrice" placeholder="Price (e.g. $16)"></div></div>
                                <div class="form-group" style="margin-bottom:8px"><input type="text" id="newSpecialDesc" placeholder="Description (e.g. With cajun butter, grits & collards)"></div>
                                <button class="btn btn-green btn-sm" onclick="addSpecial()">+ Add Special</button>
                            </div>
                        </div>
                        <div>
                            <h3 style="font-size:.85rem;font-weight:700;color:var(--red);text-transform:uppercase;letter-spacing:1px;margin-bottom:12px">86'd Items (Out of Stock)</h3>
                            <div id="eightySixList" style="display:flex;flex-direction:column;gap:8px"></div>
                            <div style="margin-top:16px;padding-top:16px;border-top:1px solid var(--g100)">
                                <div class="form-row" style="margin-bottom:8px"><div class="form-group" style="margin:0"><input type="text" id="new86Item" placeholder="Item name"></div><div class="form-group" style="margin:0"><input type="text" id="new86Reason" placeholder="Reason (e.g. Out of grouper)"></div></div>
                                <button class="btn btn-outline btn-sm" style="border-color:var(--red);color:var(--red)" onclick="add86()">+ Add 86'd Item</button>
                            </div>
                        </div>
                    </div>
                    <div class="info-box" style="margin-top:20px"><p><strong>Tip:</strong> Update specials before each shift. Front-of-house staff see this page when they log in. Click "Notify Staff" to send an email blast with today's specials and 86'd items.</p></div>
                    <div style="margin-top:14px"><button class="btn btn-rust" onclick="notifySpecials()">Notify All Staff</button></div>
                </div>
            </div>
        </div>

        <!-- ===== EMPLOYEE AVAILABILITY ===== -->
        <div class="page" id="page-availability">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
                <div></div>
                <button class="btn btn-rust" onclick="openModal('availModal')">+ Submit Availability</button>
            </div>
            <div class="card" style="margin-bottom:20px">
                <div class="card-header"><h2>Weekly Availability</h2></div>
                <table><thead><tr><th>Staff</th><th>Mon</th><th>Tue</th><th>Wed</th><th>Thu</th><th>Fri</th><th>Sat</th><th>Sun</th></tr></thead>
                <tbody id="availTableBody"></tbody></table>
            </div>
            <div class="card">
                <div class="card-header"><h2>Time-Off Requests</h2></div>
                <table><thead><tr><th>Staff</th><th>Dates</th><th>Reason</th><th>Submitted</th><th>Status</th><th></th></tr></thead>
                <tbody id="timeOffBody"></tbody></table>
            </div>
        </div>

        <!-- ===== SHIFT NOTES / HANDOFF ===== -->
        <div class="page" id="page-handoff">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
                <div class="tabs">
                    <button class="tab active" onclick="switchHandoffTab('today',this)">Today</button>
                    <button class="tab" onclick="switchHandoffTab('yesterday',this)">Yesterday</button>
                </div>
                <button class="btn btn-rust" onclick="openModal('noteModal')">+ Add Note</button>
            </div>
            <div id="handoffNotes" style="display:flex;flex-direction:column;gap:14px"></div>
        </div>

        <!-- ===== SALES DASHBOARD ===== -->
        <div class="page" id="page-sales">
            <div class="stats-row" style="margin-bottom:20px">
                <div class="stat-card"><div class="stat-label">Today's Revenue</div><div class="stat-value">$4,280</div><div class="stat-sub">+12% vs last Thu</div></div>
                <div class="stat-card"><div class="stat-label">Covers Today</div><div class="stat-value">142</div><div class="stat-sub">Avg ticket $30.14</div></div>
                <div class="stat-card"><div class="stat-label">This Week</div><div class="stat-value">$28,450</div><div class="stat-sub">On pace for $33K</div></div>
                <div class="stat-card"><div class="stat-label">MTD Revenue</div><div class="stat-value">$127,200</div><div class="stat-sub">Best January ever</div></div>
            </div>
            <div style="display:grid;grid-template-columns:1fr 1fr;gap:20px;margin-bottom:20px">
                <div class="card">
                    <div class="card-header"><h2>Daily Sales (This Week)</h2></div>
                    <div class="card-body">
                        <div id="salesBars" style="display:flex;flex-direction:column;gap:10px"></div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header"><h2>Top Sellers Today</h2></div>
                    <table><thead><tr><th>Item</th><th>Qty</th><th>Revenue</th></tr></thead>
                    <tbody>
                        <tr><td style="font-weight:600">American Animal Burger</td><td>38</td><td>$570</td></tr>
                        <tr><td style="font-weight:600">Smoked Wings</td><td>32</td><td>$448</td></tr>
                        <tr><td style="font-weight:600">Pontchartrain Pasta</td><td>24</td><td>$432</td></tr>
                        <tr><td style="font-weight:600">Shrimp & Grits</td><td>22</td><td>$352</td></tr>
                        <tr><td style="font-weight:600">Fried Green Tomatoes</td><td>28</td><td>$308</td></tr>
                        <tr><td style="font-weight:600">Black & Blue Ribeye</td><td>8</td><td>$304</td></tr>
                    </tbody></table>
                </div>
            </div>
            <div class="card">
                <div class="card-header"><h2>Log Daily Sales</h2></div>
                <div class="card-body">
                    <div class="form-row-4">
                        <div class="form-group"><label>Date</label><input type="date" id="salesDate"></div>
                        <div class="form-group"><label>Total Revenue ($)</label><input type="number" id="salesRev" placeholder="0.00" step="0.01"></div>
                        <div class="form-group"><label>Covers</label><input type="number" id="salesCovers" placeholder="0"></div>
                        <div class="form-group"><label style="opacity:0">.</label><button class="btn btn-green" onclick="logSale()" style="width:100%">Log Entry</button></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ===== MENU COSTING ===== -->
        <div class="page" id="page-costing">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
                <div></div>
                <button class="btn btn-rust" onclick="openModal('costModal')">+ Add Menu Item</button>
            </div>
            <div class="card">
                <table><thead><tr><th>Menu Item</th><th>Menu Price</th><th>Food Cost</th><th>Cost %</th><th>Profit</th><th>Status</th></tr></thead>
                <tbody id="costingBody"></tbody></table>
            </div>
            <div class="info-box" style="margin-top:16px"><p><strong>Target:</strong> Keep food cost under <strong>30%</strong> for most items. Proteins (steaks, seafood) can run 35-40%. Appetizers and drinks should be under 25% to balance out.</p></div>
        </div>

        <!-- ===== HEALTH & SAFETY ===== -->
        <div class="page" id="page-safety">
            <div class="tabs" style="margin-bottom:20px">
                <button class="tab active" onclick="switchSafetyTab('open',this)">Opening Checklist</button>
                <button class="tab" onclick="switchSafetyTab('close',this)">Closing Checklist</button>
                <button class="tab" onclick="switchSafetyTab('temps',this)">Temp Log</button>
            </div>
            <div id="safetyTab-open"><div class="card"><div class="card-header"><h2>Opening Checklist</h2><span style="font-size:.8rem;color:var(--g400)" id="safetyDateOpen"></span></div><div class="card-body" id="openChecklist"></div></div></div>
            <div id="safetyTab-close" style="display:none"><div class="card"><div class="card-header"><h2>Closing Checklist</h2><span style="font-size:.8rem;color:var(--g400)" id="safetyDateClose"></span></div><div class="card-body" id="closeChecklist"></div></div></div>
            <div id="safetyTab-temps" style="display:none">
                <div class="card">
                    <div class="card-header"><h2>Temperature Log</h2><button class="btn btn-rust btn-sm" onclick="addTempRow()">+ Log Temp</button></div>
                    <table><thead><tr><th>Equipment</th><th>Temp (Â°F)</th><th>Range</th><th>Time</th><th>Logged By</th><th>Status</th></tr></thead>
                    <tbody id="tempLogBody"></tbody></table>
                </div>
            </div>
        </div>

        <!-- ===== DOCUMENTS ===== -->
        <div class="page" id="page-docs">
            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px">
                <div class="tabs">
                    <button class="tab active" onclick="switchDocsTab('training',this)">Training</button>
                    <button class="tab" onclick="switchDocsTab('recipes',this)">Recipes & Specs</button>
                    <button class="tab" onclick="switchDocsTab('policies',this)">Policies</button>
                </div>
            </div>
            <div id="docsTab-training"><div id="trainingDocs"></div></div>
            <div id="docsTab-recipes" style="display:none"><div id="recipeDocs"></div></div>
            <div id="docsTab-policies" style="display:none"><div id="policyDocs"></div></div>
        </div>

        <!-- ===== TEAM MEMBERS ===== -->
        <div class="page" id="page-team">
            <div class="card">
                <div class="card-header"><h2>Staff Roster</h2></div>
                <table><thead><tr><th>Name</th><th>Role</th><th>Position</th><th>Email</th><th>Phone</th><th>Weekly Hours</th><th>Status</th></tr></thead>
                <tbody>
                    <tr><td style="font-weight:600">Marcus Thompson</td><td>Management</td><td>General Manager</td><td>marcus@mudtownalabama.com</td><td>(205) 967-3301</td><td>45</td><td><span class="badge badge-active">Active</span></td></tr>
                    <tr><td style="font-weight:600">Rachel Kim</td><td>Front of House</td><td>Lead Host</td><td>rachel@mudtownalabama.com</td><td>(205) 967-3302</td><td>35</td><td><span class="badge badge-active">Active</span></td></tr>
                    <tr><td style="font-weight:600">Devon Williams</td><td>Kitchen</td><td>Head Chef</td><td>devon@mudtownalabama.com</td><td>(205) 967-3303</td><td>45</td><td><span class="badge badge-active">Active</span></td></tr>
                    <tr><td style="font-weight:600">Ashley Rodriguez</td><td>Front of House</td><td>Lead Server</td><td>ashley@mudtownalabama.com</td><td>(205) 967-3304</td><td>32</td><td><span class="badge badge-active">Active</span></td></tr>
                    <tr><td style="font-weight:600">Jake Mitchell</td><td>Bar</td><td>Head Bartender</td><td>jake@mudtownalabama.com</td><td>(205) 967-3305</td><td>36</td><td><span class="badge badge-active">Active</span></td></tr>
                    <tr><td style="font-weight:600">Maria Santos</td><td>Kitchen</td><td>Line Cook</td><td>maria@mudtownalabama.com</td><td>(205) 967-3306</td><td>38</td><td><span class="badge badge-active">Active</span></td></tr>
                    <tr><td style="font-weight:600">Tyler Brooks</td><td>Kitchen</td><td>Prep Cook</td><td>tyler@mudtownalabama.com</td><td>(205) 967-3307</td><td>30</td><td><span class="badge badge-active">Active</span></td></tr>
                    <tr><td style="font-weight:600">Jasmine Cooper</td><td>Front of House</td><td>Server</td><td>jasmine@mudtownalabama.com</td><td>(205) 967-3308</td><td>28</td><td><span class="badge badge-active">Active</span></td></tr>
                    <tr><td style="font-weight:600">Chris Nguyen</td><td>Front of House</td><td>Server</td><td>chris@mudtownalabama.com</td><td>(205) 967-3309</td><td>24</td><td><span class="badge badge-active">Active</span></td></tr>
                    <tr><td style="font-weight:600">Lauren Hayes</td><td>Bar</td><td>Bartender</td><td>lauren@mudtownalabama.com</td><td>(205) 967-3310</td><td>28</td><td><span class="badge badge-active">Active</span></td></tr>
                    <tr><td style="font-weight:600">David Park</td><td>Kitchen</td><td>Dishwasher</td><td>david@mudtownalabama.com</td><td>(205) 967-3311</td><td>30</td><td><span class="badge badge-active">Active</span></td></tr>
                    <tr><td style="font-weight:600">Brittany James</td><td>Front of House</td><td>Host</td><td>brittany@mudtownalabama.com</td><td>(205) 967-3312</td><td>20</td><td><span class="badge badge-active">Active</span></td></tr>
                    <tr><td style="font-weight:600">Kevin Moore</td><td>Front of House</td><td>Busser</td><td>kevin@mudtownalabama.com</td><td>(205) 967-3313</td><td>22</td><td><span class="badge badge-active">Active</span></td></tr>
                    <tr><td style="font-weight:600">Emily Chen</td><td>Front of House</td><td>Server</td><td>emily@mudtownalabama.com</td><td>(205) 967-3314</td><td>26</td><td><span class="badge badge-off">Day Off</span></td></tr>
                </tbody></table>
            </div>
        </div>
    </div>
</div>

<!-- SHIFT MODAL -->
<div class="modal-overlay" id="shiftModal"><div class="modal">
    <div class="modal-header"><h2>Add Shift</h2><button class="modal-close" onclick="closeModal('shiftModal')">&times;</button></div>
    <div class="modal-body">
        <div class="form-row"><div class="form-group"><label>Staff Member</label><select id="shStaff"><option>Rachel Kim</option><option>Devon Williams</option><option>Ashley Rodriguez</option><option>Jake Mitchell</option><option>Maria Santos</option><option>Tyler Brooks</option><option>Jasmine Cooper</option><option>Chris Nguyen</option><option>Lauren Hayes</option><option>David Park</option><option>Brittany James</option><option>Kevin Moore</option><option>Emily Chen</option></select></div><div class="form-group"><label>Role</label><select id="shRole"><option>Host</option><option>Server</option><option>Kitchen</option><option>Bar</option><option>Busser</option><option>Prep</option><option>Manager</option></select></div></div>
        <div class="form-row"><div class="form-group"><label>Date</label><input type="date" id="shDate"></div><div class="form-group"><label>Shift</label><select id="shShift"><option value="10:00-16:00">Lunch (10 AM - 4 PM)</option><option value="11:00-15:00">Mid-Day (11 AM - 3 PM)</option><option value="16:00-22:00">Dinner (4 PM - 10 PM)</option><option value="16:00-23:00">Dinner Close (4 PM - 11 PM)</option><option value="10:00-22:00">Double (10 AM - 10 PM)</option><option value="08:00-11:00">Prep (8 AM - 11 AM)</option></select></div></div>
        <div class="form-group"><label>Notes</label><textarea id="shNotes" placeholder="Section assignment, special duties..."></textarea></div>
        <div class="info-box"><p><strong>Notification:</strong> Staff member will receive an email with their shift details and a reminder.</p></div>
    </div>
    <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('shiftModal')">Cancel</button><button class="btn btn-green" onclick="addShift()">Add Shift & Notify</button></div>
</div></div>

<!-- ORDER MODAL -->
<div class="modal-overlay" id="orderModal"><div class="modal modal-lg">
    <div class="modal-header"><h2>New Purchase Order</h2><button class="modal-close" onclick="closeModal('orderModal')">&times;</button></div>
    <div class="modal-body">
        <div class="form-row"><div class="form-group"><label>Vendor</label><select id="poVendor"><option>Sysco Birmingham</option><option>US Foods</option><option>Birmingham Beverage</option><option>Republic National</option><option>Flowers Foods</option><option>Cahaba Produce</option></select></div><div class="form-group"><label>Delivery Date</label><input type="date" id="poDate"></div></div>
        <div id="poLines"><div class="form-row-3 po-line"><div class="form-group"><label>Item</label><input type="text" placeholder="Item name"></div><div class="form-group"><label>Quantity</label><input type="text" placeholder="e.g. 2 cases"></div><div class="form-group"><label>Est. Cost ($)</label><input type="number" placeholder="0.00" step="0.01"></div></div></div>
        <button class="btn btn-outline btn-sm" onclick="addPOLine()" style="margin-bottom:16px">+ Add Item</button>
        <div class="form-group"><label>Notes</label><textarea id="poNotes" placeholder="Special instructions, rush items..."></textarea></div>
    </div>
    <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('orderModal')">Cancel</button><button class="btn btn-rust" onclick="createPO()">Create Order</button></div>
</div></div>

<!-- CATERING MODAL -->
<div class="modal-overlay" id="cateringModal"><div class="modal modal-lg">
    <div class="modal-header"><h2>New Catering Estimate</h2><button class="modal-close" onclick="closeModal('cateringModal')">&times;</button></div>
    <div class="modal-body">
        <div class="form-row"><div class="form-group"><label>Client Name *</label><input type="text" id="catClient"></div><div class="form-group"><label>Client Email *</label><input type="email" id="catEmail"></div></div>
        <div class="form-row"><div class="form-group"><label>Event Type</label><select id="catType"><option>Corporate Lunch</option><option>Wedding Reception</option><option>Birthday Party</option><option>Office Catering</option><option>Holiday Party</option><option>Rehearsal Dinner</option><option>Private Dining</option><option>Custom Event</option></select></div><div class="form-group"><label>Guest Count</label><input type="number" id="catGuests" value="25" min="1"></div></div>
        <div class="form-row"><div class="form-group"><label>Event Date</label><input type="date" id="catDate"></div><div class="form-group"><label>Event Address</label><input type="text" id="catAddr" placeholder="Venue address"></div></div>
        <div id="catLines"><div class="form-row-3 cat-line"><div class="form-group"><label>Menu Item</label><input type="text" placeholder="e.g. Smoked Wings Platter"></div><div class="form-group"><label>Servings</label><input type="number" value="25" min="1"></div><div class="form-group"><label>Price Per ($)</label><input type="number" placeholder="0.00" step="0.01"></div></div></div>
        <button class="btn btn-outline btn-sm" onclick="addCatLine()" style="margin-bottom:16px">+ Add Menu Item</button>
        <div class="form-group"><label>Notes</label><textarea id="catNotes" placeholder="Dietary restrictions, setup requirements, service style..."></textarea></div>
    </div>
    <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('cateringModal')">Cancel</button><button class="btn btn-rust" onclick="createCatering()">Create Estimate</button></div>
</div></div>

<!-- AVAILABILITY MODAL -->
<div class="modal-overlay" id="availModal"><div class="modal">
    <div class="modal-header"><h2>Submit Availability</h2><button class="modal-close" onclick="closeModal('availModal')">&times;</button></div>
    <div class="modal-body">
        <div class="form-group"><label>Staff Member</label><select id="avStaff"><option>Rachel Kim</option><option>Devon Williams</option><option>Ashley Rodriguez</option><option>Jake Mitchell</option><option>Maria Santos</option><option>Tyler Brooks</option><option>Jasmine Cooper</option><option>Chris Nguyen</option><option>Lauren Hayes</option><option>David Park</option><option>Brittany James</option><option>Kevin Moore</option><option>Emily Chen</option></select></div>
        <p style="font-size:.8rem;font-weight:600;color:var(--g600);margin-bottom:10px">Available shifts:</p>
        <div style="display:grid;grid-template-columns:repeat(7,1fr);gap:6px;text-align:center;margin-bottom:16px">
            <div style="font-size:.7rem;font-weight:700;color:var(--g500)">MON</div><div style="font-size:.7rem;font-weight:700;color:var(--g500)">TUE</div><div style="font-size:.7rem;font-weight:700;color:var(--g500)">WED</div><div style="font-size:.7rem;font-weight:700;color:var(--g500)">THU</div><div style="font-size:.7rem;font-weight:700;color:var(--g500)">FRI</div><div style="font-size:.7rem;font-weight:700;color:var(--g500)">SAT</div><div style="font-size:.7rem;font-weight:700;color:var(--g500)">SUN</div>
            <select id="avMon" style="font-size:.75rem;padding:6px 2px"><option>Any</option><option>Lunch</option><option>Dinner</option><option>Off</option></select>
            <select id="avTue" style="font-size:.75rem;padding:6px 2px"><option>Any</option><option>Lunch</option><option>Dinner</option><option>Off</option></select>
            <select id="avWed" style="font-size:.75rem;padding:6px 2px"><option>Any</option><option>Lunch</option><option>Dinner</option><option>Off</option></select>
            <select id="avThu" style="font-size:.75rem;padding:6px 2px"><option>Any</option><option>Lunch</option><option>Dinner</option><option>Off</option></select>
            <select id="avFri" style="font-size:.75rem;padding:6px 2px"><option>Any</option><option>Lunch</option><option>Dinner</option><option>Off</option></select>
            <select id="avSat" style="font-size:.75rem;padding:6px 2px"><option>Any</option><option>Lunch</option><option>Dinner</option><option>Off</option></select>
            <select id="avSun" style="font-size:.75rem;padding:6px 2px"><option>Any</option><option>Lunch</option><option>Dinner</option><option>Off</option></select>
        </div>
    </div>
    <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('availModal')">Cancel</button><button class="btn btn-green" onclick="submitAvail()">Save Availability</button></div>
</div></div>

<!-- SHIFT NOTE MODAL -->
<div class="modal-overlay" id="noteModal"><div class="modal">
    <div class="modal-header"><h2>Add Shift Note</h2><button class="modal-close" onclick="closeModal('noteModal')">&times;</button></div>
    <div class="modal-body">
        <div class="form-row"><div class="form-group"><label>From</label><select id="noteFrom"><option>Marcus Thompson (GM)</option><option>Devon Williams (Chef)</option><option>Rachel Kim (Lead Host)</option><option>Ashley Rodriguez (Lead Server)</option><option>Jake Mitchell (Bartender)</option></select></div><div class="form-group"><label>Category</label><select id="noteCat"><option>General</option><option>Reservations</option><option>86'd Items</option><option>Equipment</option><option>Customer Issue</option><option>Prep Notes</option></select></div></div>
        <div class="form-group"><label>Note</label><textarea id="noteText" rows="3" placeholder="e.g. Table 12 reserved for party of 10 at 7pm. They want the patio."></textarea></div>
        <div class="form-group"><label>Priority</label><select id="notePriority"><option>Normal</option><option>Important</option><option>Urgent</option></select></div>
    </div>
    <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('noteModal')">Cancel</button><button class="btn btn-rust" onclick="addHandoffNote()">Post Note</button></div>
</div></div>

<!-- MENU COST MODAL -->
<div class="modal-overlay" id="costModal"><div class="modal">
    <div class="modal-header"><h2>Add Menu Item Cost</h2><button class="modal-close" onclick="closeModal('costModal')">&times;</button></div>
    <div class="modal-body">
        <div class="form-row"><div class="form-group"><label>Item Name</label><input type="text" id="costName" placeholder="e.g. American Animal Burger"></div><div class="form-group"><label>Menu Price ($)</label><input type="number" id="costPrice" step="0.01" placeholder="15.00"></div></div>
        <p style="font-size:.8rem;font-weight:600;color:var(--g600);margin:12px 0 8px">Ingredients:</p>
        <div id="costIngredients"><div class="form-row-3 cost-ing-line"><div class="form-group"><label>Ingredient</label><input type="text" placeholder="e.g. Ground beef 8oz"></div><div class="form-group"><label>Cost ($)</label><input type="number" step="0.01" placeholder="2.50"></div><div class="form-group"><label></label></div></div></div>
        <button class="btn btn-outline btn-sm" onclick="addCostIngLine()" style="margin-bottom:12px">+ Add Ingredient</button>
    </div>
    <div class="modal-footer"><button class="btn btn-outline" onclick="closeModal('costModal')">Cancel</button><button class="btn btn-green" onclick="addCostItem()">Add Item</button></div>
</div></div>

<div class="toast" id="toast"></div>

<script>
const BIZ="Mudtown Eat & Drink",ADDR="3144 Green Valley Rd, Vestavia Hills, AL 35243",PHONE="(205) 967-3300",EMAIL="info@mudtownalabama.com";
const TITLES={dashboard:'Dashboard',specials:'Daily Specials',scheduling:'Staff Scheduling',availability:'Employee Availability',handoff:'Shift Notes & Handoff',inventory:'Inventory & Orders',catering:'Catering Estimates',sales:'Sales Dashboard',costing:'Menu Costing',chat:'Team Chat',team:'Team Members',safety:'Health & Safety',docs:'Documents & Training'};
const ROLES={Host:'chip-host',Server:'chip-server',Kitchen:'chip-kitchen',Bar:'chip-bar',Busser:'chip-bus',Prep:'chip-kitchen',Manager:'chip-server'};
const DAYS=['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];

// ===== NAV =====
function switchPage(p,el){document.querySelectorAll('.page').forEach(x=>x.classList.remove('active'));document.getElementById('page-'+p).classList.add('active');document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));if(el)el.classList.add('active');document.getElementById('pageTitle').textContent=TITLES[p]||p;document.getElementById('sidebar').classList.remove('open')}
function openModal(id){document.getElementById(id).classList.add('open')}
function closeModal(id){document.getElementById(id).classList.remove('open')}
function showToast(m,t){const e=document.getElementById('toast');e.textContent=m;e.className='toast show'+(t?' '+t:'');setTimeout(()=>e.className='toast',3500)}

// ===== SCHEDULING DATA =====
const today=new Date();const mon=new Date(today);mon.setDate(today.getDate()-today.getDay()+1);
function dateStr(d){return d.toISOString().split('T')[0]}
function fmtDate(d){return new Date(d+'T00:00:00').toLocaleDateString('en-US',{month:'short',day:'numeric'})}

const shifts=[
    {date:dateStr(new Date(mon.getTime()+0)),time:'10:00-16:00',role:'Host',staff:'Rachel Kim',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+0)),time:'10:00-22:00',role:'Kitchen',staff:'Devon Williams',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+0)),time:'10:00-16:00',role:'Server',staff:'Ashley Rodriguez',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+0)),time:'16:00-22:00',role:'Server',staff:'Jasmine Cooper',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+0)),time:'16:00-22:00',role:'Bar',staff:'Jake Mitchell',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+0)),time:'10:00-16:00',role:'Busser',staff:'Kevin Moore',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+0)),time:'08:00-11:00',role:'Prep',staff:'Tyler Brooks',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+0)),time:'10:00-22:00',role:'Kitchen',staff:'Maria Santos',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+86400000)),time:'10:00-16:00',role:'Host',staff:'Brittany James',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+86400000)),time:'10:00-22:00',role:'Kitchen',staff:'Devon Williams',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+86400000)),time:'10:00-16:00',role:'Server',staff:'Chris Nguyen',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+86400000)),time:'16:00-23:00',role:'Server',staff:'Ashley Rodriguez',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+86400000)),time:'16:00-23:00',role:'Bar',staff:'Lauren Hayes',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+86400000)),time:'16:00-22:00',role:'Busser',staff:'Kevin Moore',status:'Pending'},
    {date:dateStr(new Date(mon.getTime()+2*86400000)),time:'10:00-16:00',role:'Host',staff:'Rachel Kim',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+2*86400000)),time:'10:00-22:00',role:'Kitchen',staff:'Devon Williams',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+2*86400000)),time:'16:00-22:00',role:'Server',staff:'Emily Chen',status:'Pending'},
    {date:dateStr(new Date(mon.getTime()+3*86400000)),time:'10:00-16:00',role:'Server',staff:'Jasmine Cooper',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+3*86400000)),time:'16:00-23:00',role:'Bar',staff:'Jake Mitchell',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+4*86400000)),time:'10:00-22:00',role:'Kitchen',staff:'Devon Williams',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+4*86400000)),time:'10:00-16:00',role:'Host',staff:'Rachel Kim',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+4*86400000)),time:'16:00-23:00',role:'Server',staff:'Ashley Rodriguez',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+4*86400000)),time:'16:00-23:00',role:'Bar',staff:'Jake Mitchell',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+4*86400000)),time:'16:00-23:00',role:'Server',staff:'Chris Nguyen',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+5*86400000)),time:'10:00-22:00',role:'Kitchen',staff:'Devon Williams',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+5*86400000)),time:'10:00-16:00',role:'Kitchen',staff:'Maria Santos',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+5*86400000)),time:'11:00-15:00',role:'Host',staff:'Rachel Kim',status:'Confirmed'},
    {date:dateStr(new Date(mon.getTime()+5*86400000)),time:'11:00-15:00',role:'Host',staff:'Brittany James',status:'Confirmed'},
];

let weekOffset=0;
function changeWeek(d){weekOffset+=d;renderScheduleGrid();renderShiftTable();document.getElementById('weekLabel').textContent=weekOffset===0?'This Week':weekOffset>0?weekOffset+' Week'+(weekOffset>1?'s':'')+' Ahead':Math.abs(weekOffset)+' Week'+(Math.abs(weekOffset)>1?'s':'')+' Ago'}

function renderScheduleGrid(){
    const g=document.getElementById('schedGrid');
    const wk=new Date(mon.getTime()+weekOffset*7*86400000);
    const timeSlots=['10 AM','11 AM','12 PM','1 PM','2 PM','3 PM','4 PM','5 PM','6 PM','7 PM','8 PM','9 PM'];
    let html='<div class="sched-header"></div>';
    for(let i=0;i<7;i++){const d=new Date(wk.getTime()+i*86400000);html+=`<div class="sched-header">${DAYS[d.getDay()]}<br>${d.getMonth()+1}/${d.getDate()}</div>`}
    timeSlots.forEach(t=>{
        const hour=t.includes('PM')&&!t.includes('12')?parseInt(t)+12:parseInt(t);
        html+=`<div class="sched-time">${t}</div>`;
        for(let i=0;i<7;i++){
            const ds=dateStr(new Date(wk.getTime()+i*86400000));
            const cellShifts=shifts.filter(s=>{
                if(s.date!==ds)return false;
                const[startH]=s.time.split('-')[0].split(':').map(Number);
                const[endH]=s.time.split('-')[1].split(':').map(Number);
                return hour>=startH&&hour<endH;
            });
            html+=`<div class="sched-cell">${cellShifts.map(s=>`<span class="sched-chip ${ROLES[s.role]||'chip-server'}">${s.staff.split(' ')[0]}</span>`).join('')}</div>`;
        }
    });
    g.innerHTML=html;
}

function renderShiftTable(){
    const wk=new Date(mon.getTime()+weekOffset*7*86400000);
    const wkEnd=new Date(wk.getTime()+7*86400000);
    const filtered=shifts.filter(s=>{const d=new Date(s.date+'T00:00:00');return d>=wk&&d<wkEnd}).sort((a,b)=>a.date.localeCompare(b.date)||a.time.localeCompare(b.time));
    document.getElementById('shiftTableBody').innerHTML=filtered.map((s,i)=>{
        const[start,end]=s.time.split('-');
        const fStart=fmtTime(start),fEnd=fmtTime(end);
        return`<tr><td>${fmtDate(s.date)}</td><td>${fStart} - ${fEnd}</td><td><span class="sched-chip ${ROLES[s.role]||'chip-server'}" style="display:inline-block;padding:3px 10px;border-radius:6px">${s.role}</span></td><td style="font-weight:600">${s.staff}</td><td><span class="badge badge-${s.status.toLowerCase()}">${s.status}</span></td><td><button class="btn btn-outline btn-sm" onclick="notifyShift(${i})">Notify</button></td></tr>`;
    }).join('');
}

function fmtTime(t){let[h,m]=t.split(':');h=+h;const ap=h>=12?'PM':'AM';h=h%12||12;return h+':'+m+' '+ap}

function addShift(){
    const staff=document.getElementById('shStaff').value;
    const role=document.getElementById('shRole').value;
    const date=document.getElementById('shDate').value;
    const time=document.getElementById('shShift').value;
    if(!date){showToast('Please select a date.');return}
    shifts.push({date,time,role,staff,status:'Pending'});
    const[start,end]=time.split('-');
    const subj=encodeURIComponent('Shift Scheduled: '+role+' - '+fmtDate(date));
    const body=encodeURIComponent('Hi '+staff.split(' ')[0]+',\n\nYou\'ve been scheduled for a shift at Mudtown:\n\nRole: '+role+'\nDate: '+fmtDate(date)+'\nTime: '+fmtTime(start)+' - '+fmtTime(end)+'\nLocation: '+ADDR+'\n\nGoogle Maps:\nhttps://www.google.com/maps/dir/?api=1&destination='+encodeURIComponent(ADDR)+'\n\n'+(document.getElementById('shNotes').value?'Notes: '+document.getElementById('shNotes').value+'\n\n':'')+'Thanks,\n'+BIZ+'\n'+PHONE);
    window.open('mailto:'+staff.toLowerCase().replace(' ','')+'@mudtownalabama.com?subject='+subj+'&body='+body,'_self');
    renderScheduleGrid();renderShiftTable();renderDashboard();closeModal('shiftModal');
    showToast('Shift added for '+staff+'!','success');
}

function notifyShift(i){
    const s=shifts[i];if(!s)return;
    const[start,end]=s.time.split('-');
    const subj=encodeURIComponent('Shift Reminder: '+s.role+' - '+fmtDate(s.date));
    const body=encodeURIComponent('Hi '+s.staff.split(' ')[0]+',\n\nReminder of your upcoming shift:\n\nRole: '+s.role+'\nDate: '+fmtDate(s.date)+'\nTime: '+fmtTime(start)+' - '+fmtTime(end)+'\nLocation: '+ADDR+'\n\nDirections:\nhttps://www.google.com/maps/dir/?api=1&destination='+encodeURIComponent(ADDR)+'\n\nThanks,\n'+BIZ);
    window.open('mailto:'+s.staff.toLowerCase().replace(' ','')+'@mudtownalabama.com?subject='+subj+'&body='+body,'_self');
    showToast('Reminder sent to '+s.staff,'success');
}

// ===== INVENTORY =====
const inventory=[
    {item:'Ground Beef (80/20)',cat:'Protein',stock:18,par:25,unit:'lbs'},
    {item:'Chicken Tenders',cat:'Protein',stock:40,par:50,unit:'lbs'},
    {item:'Gulf Shrimp (16/20)',cat:'Seafood',stock:8,par:20,unit:'lbs'},
    {item:'Conecuh Sausage',cat:'Protein',stock:6,par:15,unit:'lbs'},
    {item:'Burger Buns',cat:'Bakery',stock:72,par:100,unit:'ct'},
    {item:'Texas Toast',cat:'Bakery',stock:48,par:60,unit:'ct'},
    {item:'Green Tomatoes',cat:'Produce',stock:12,par:30,unit:'lbs'},
    {item:'Romaine Lettuce',cat:'Produce',stock:15,par:20,unit:'heads'},
    {item:'Pepper Jack Cheese',cat:'Dairy',stock:10,par:15,unit:'lbs'},
    {item:'Blue Cheese Crumbles',cat:'Dairy',stock:4,par:10,unit:'lbs'},
    {item:'Tito\'s Vodka',cat:'Spirits',stock:3,par:8,unit:'btls'},
    {item:'Bourbon (Well)',cat:'Spirits',stock:5,par:10,unit:'btls'},
    {item:'IPA Kegs (local)',cat:'Beer',stock:2,par:4,unit:'kegs'},
    {item:'Lager Kegs',cat:'Beer',stock:3,par:4,unit:'kegs'},
    {item:'Fry Oil',cat:'Supplies',stock:8,par:12,unit:'gal'},
    {item:'To-Go Containers',cat:'Supplies',stock:200,par:500,unit:'ct'},
];

const purchaseOrders=[
    {num:'PO-401',vendor:'Sysco Birmingham',items:'Ground Beef, Chicken, Fry Oil, To-Go Containers',total:1842,date:'Jan 27, 2026',status:'Delivered'},
    {num:'PO-402',vendor:'Cahaba Produce',items:'Green Tomatoes, Romaine, Onions, JalapeÃ±os',total:340,date:'Jan 29, 2026',status:'Ordered'},
    {num:'PO-403',vendor:'Birmingham Beverage',items:'IPA Kegs x4, Lager Kegs x2, Wine Cases x3',total:1260,date:'Jan 26, 2026',status:'Delivered'},
    {num:'PO-404',vendor:'Republic National',items:'Tito\'s x6, Bourbon x4, Tequila x3, Rum x2',total:890,date:'Jan 30, 2026',status:'Pending'},
];
let poCount=404;

function renderStock(){
    document.getElementById('stockTableBody').innerHTML=inventory.map(i=>{
        const pct=Math.round((i.stock/i.par)*100);
        const color=pct<=30?'var(--red)':pct<=60?'var(--orange)':'var(--green)';
        const badge=pct<=30?'<span class="badge badge-low">Low</span>':pct<=60?'<span class="badge badge-pending">Moderate</span>':'<span class="badge badge-ok">Good</span>';
        return`<tr><td style="font-weight:600">${i.item}</td><td>${i.cat}</td><td>${i.stock} ${i.unit}</td><td>${i.par} ${i.unit}</td><td><div class="inv-status"><div class="inv-bar"><div class="inv-fill" style="width:${Math.min(pct,100)}%;background:${color}"></div></div><span style="font-size:.78rem;color:var(--g500)">${pct}%</span></div></td><td>${badge}</td><td>${pct<=30?'<button class="btn btn-outline btn-sm" onclick="showToast(\'Added to next order\',\'success\')">Reorder</button>':''}</td></tr>`;
    }).join('');
}

function renderPO(){
    document.getElementById('poTableBody').innerHTML=purchaseOrders.map(p=>{
        const badge=p.status==='Delivered'?'badge-confirmed':p.status==='Ordered'?'badge-ordered':'badge-pending';
        return`<tr><td style="font-weight:600">${p.num}</td><td>${p.vendor}</td><td style="font-size:.82rem">${p.items}</td><td>$${p.total.toLocaleString()}</td><td>${p.date}</td><td><span class="badge ${badge}">${p.status}</span></td><td><button class="btn btn-outline btn-sm" onclick="showToast('Order details sent to vendor','success')">Email Vendor</button></td></tr>`;
    }).join('');
}

function addPOLine(){const c=document.getElementById('poLines'),r=document.createElement('div');r.className='form-row-3 po-line';r.innerHTML='<div class="form-group"><label>Item</label><input type="text" placeholder="Item name"></div><div class="form-group"><label>Quantity</label><input type="text" placeholder="e.g. 2 cases"></div><div class="form-group"><label>Est. Cost ($)</label><input type="number" placeholder="0.00" step="0.01"></div>';c.appendChild(r)}

function createPO(){
    poCount++;const num='PO-'+poCount;
    const vendor=document.getElementById('poVendor').value;
    const rows=document.querySelectorAll('#poLines .po-line');
    let items=[],total=0;
    rows.forEach(r=>{const inp=r.querySelectorAll('input');items.push(inp[0].value.trim()||'Item');total+=parseFloat(inp[2].value)||0});
    purchaseOrders.unshift({num,vendor,items:items.join(', '),total,date:new Date().toLocaleDateString('en-US',{month:'short',day:'numeric',year:'numeric'}),status:'Pending'});
    renderPO();closeModal('orderModal');showToast('Purchase order '+num+' created!','success');
}

function switchInvTab(t,el){['stock','orders','vendors'].forEach(x=>document.getElementById('invTab-'+x).style.display=x===t?'block':'none');el.parentElement.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));el.classList.add('active')}

// ===== CATERING =====
const catering=[
    {num:'CAT-001',client:'Birmingham Tech Co.',email:'events@bhamtech.com',type:'Corporate Lunch',date:'Feb 12, 2026',guests:40,items:[{desc:'Smoked Wings Platter',qty:40,price:8},{desc:'Burger Sliders Bar',qty:40,price:10},{desc:'House Chips & Queso',qty:4,price:35},{desc:'Sweet Tea & Lemonade',qty:40,price:3}],notes:'Setup by 11:30 AM. Need serving staff (2).',addr:'2100 Morris Ave, Birmingham, AL',status:'Sent'},
    {num:'CAT-002',client:'Jennifer & Mark Adams',email:'jadams@email.com',type:'Rehearsal Dinner',date:'Mar 8, 2026',guests:60,items:[{desc:'Fried Green Tomatoes (passed)',qty:60,price:4},{desc:'Black & Blue Ribeye',qty:30,price:38},{desc:'Shrimp & Grits',qty:30,price:16},{desc:'Cookie Sundae Dessert',qty:60,price:6}],notes:'Outdoor setup at venue. Full bar service requested.',addr:'The Club, 1 Robert Trent Jones Trail, Birmingham, AL',status:'Pending'},
];
let catCount=2;

function renderCatering(){
    document.getElementById('cateringTableBody').innerHTML=catering.map((c,i)=>{
        const tot=c.items.reduce((s,x)=>s+x.qty*x.price,0);
        return`<tr><td style="font-weight:600">${c.num}</td><td>${c.client}<br><span style="font-size:.78rem;color:var(--g400)">${c.email}</span></td><td>${c.type}</td><td>${c.date}</td><td>${c.guests}</td><td>$${tot.toLocaleString()}</td><td><span class="badge badge-${c.status==='Sent'?'confirmed':'pending'}">${c.status}</span></td><td><div class="btn-group"><button class="btn btn-outline btn-sm" onclick="previewCatering(${i})">View</button><button class="btn btn-outline btn-sm" onclick="emailCatering(${i})">Email</button></div></td></tr>`;
    }).join('');
}

function previewCatering(i){
    const c=catering[i];if(!c)return;
    const sub=c.items.reduce((s,x)=>s+x.qty*x.price,0);const tax=sub*0.09;const tot=sub+tax;
    const area=document.getElementById('cateringPreviewArea');
    area.style.display='block';
    area.innerHTML=`<div class="card"><div class="card-header"><h2>Catering Estimate Preview</h2><div class="btn-group"><button class="btn btn-rust btn-sm" onclick="emailCatering(${i})">Email to Client</button><button class="btn btn-outline btn-sm" onclick="document.getElementById('cateringPreviewArea').style.display='none'">Close</button></div></div><div class="card-body"><div class="estimate-preview">
    <div class="ep-header"><div class="ep-company"><h3>${BIZ}</h3><p>${ADDR}</p><p>${PHONE} &bull; ${EMAIL}</p></div><div class="ep-est-num"><h4>Estimate ${c.num}</h4><p>${c.date}</p><p>${c.type} &bull; ${c.guests} guests</p></div></div>
    <div class="ep-parties"><div><h5>From</h5><p><strong>${BIZ}</strong><br>${ADDR}</p></div><div><h5>To</h5><p><strong>${c.client}</strong><br>${c.email}${c.addr?'<br>'+c.addr:''}</p></div></div>
    <table class="ep-table"><thead><tr><th>Menu Item</th><th>Servings</th><th class="right">Per Person</th><th class="right">Total</th></tr></thead><tbody>${c.items.map(x=>`<tr><td>${x.desc}</td><td>${x.qty}</td><td class="right">$${x.price.toFixed(2)}</td><td class="right">$${(x.qty*x.price).toFixed(2)}</td></tr>`).join('')}</tbody></table>
    <div class="ep-totals"><div class="line"><span>Subtotal</span><span>$${sub.toFixed(2)}</span></div><div class="line"><span>Tax (9%)</span><span>$${tax.toFixed(2)}</span></div><div class="line total"><span>Total</span><span>$${tot.toFixed(2)}</span></div></div>
    ${c.notes?'<div style="margin-top:16px;padding-top:16px;border-top:1px solid var(--g100)"><p style="font-size:.82rem;color:var(--g400)">'+c.notes+'</p></div>':''}
    </div></div></div>`;
    area.scrollIntoView({behavior:'smooth'});
}

function emailCatering(i){
    const c=catering[i];if(!c)return;
    const tot=c.items.reduce((s,x)=>s+x.qty*x.price,0);const tax=tot*0.09;
    const subj=encodeURIComponent('Catering Estimate '+c.num+' - Mudtown Eat & Drink');
    const body=encodeURIComponent('Hi '+c.client.split(' ')[0]+',\n\nThank you for your interest in catering with Mudtown! Here\'s your estimate:\n\nEvent: '+c.type+'\nDate: '+c.date+'\nGuests: '+c.guests+'\n\nMenu:\n'+c.items.map(x=>'- '+x.desc+' ('+x.qty+' servings) - $'+(x.qty*x.price).toFixed(2)).join('\n')+'\n\nSubtotal: $'+tot.toFixed(2)+'\nTax (9%): $'+tax.toFixed(2)+'\nTotal: $'+(tot+tax).toFixed(2)+'\n\n'+(c.notes?'Notes: '+c.notes+'\n\n':'')+'We\'d love to make your event special! Call us at '+PHONE+' to confirm.\n\nCheers,\n'+BIZ+'\n'+ADDR+'\n'+PHONE);
    window.open('mailto:'+c.email+'?subject='+subj+'&body='+body,'_self');
    showToast('Estimate email opened for '+c.client,'success');
}

function addCatLine(){const c=document.getElementById('catLines'),r=document.createElement('div');r.className='form-row-3 cat-line';r.innerHTML='<div class="form-group"><label>Menu Item</label><input type="text" placeholder="e.g. Burger Bar"></div><div class="form-group"><label>Servings</label><input type="number" value="25" min="1"></div><div class="form-group"><label>Price Per ($)</label><input type="number" placeholder="0.00" step="0.01"></div>';c.appendChild(r)}

function createCatering(){
    const client=document.getElementById('catClient').value.trim();
    const email=document.getElementById('catEmail').value.trim();
    if(!client||!email){showToast('Client name and email required.');return}
    catCount++;const num='CAT-'+String(catCount).padStart(3,'0');
    const rows=document.querySelectorAll('#catLines .cat-line');const items=[];
    rows.forEach(r=>{const inp=r.querySelectorAll('input');items.push({desc:inp[0].value.trim()||'Menu Item',qty:parseInt(inp[1].value)||25,price:parseFloat(inp[2].value)||0})});
    catering.unshift({num,client,email,type:document.getElementById('catType').value,date:document.getElementById('catDate').value?fmtDate(document.getElementById('catDate').value):'TBD',guests:parseInt(document.getElementById('catGuests').value)||25,items,notes:document.getElementById('catNotes').value.trim(),addr:document.getElementById('catAddr').value.trim(),status:'Pending'});
    renderCatering();closeModal('cateringModal');showToast('Catering estimate '+num+' created!','success');
}

// ===== CHAT =====
const chatData={
    general:[
        {from:'Marcus T.',avatar:'MT',color:'var(--rust)',msg:'Hey team - reminder we have a private party Friday night. 35 guests, they want the back patio. Need extra setup starting at 3 PM.',time:'10:32 AM',own:false},
        {from:'Devon W.',avatar:'DW',color:'var(--sage)',msg:'Got it. I\'ll prep extra wings and fried green tomato platters. Should I do the short ribs too?',time:'10:45 AM',own:false},
        {from:'Marcus T.',avatar:'MT',color:'var(--rust)',msg:'Yes do the tablitas. They also want a burger bar setup. Let\'s plan for 40 servings to be safe.',time:'10:48 AM',own:true},
        {from:'Rachel K.',avatar:'RK',color:'#7c3aed',msg:'I can come in early to help with table setup. Do they need a reserved section sign?',time:'11:02 AM',own:false},
        {from:'Jake M.',avatar:'JM',color:'var(--gold)',msg:'I\'ll stock extra bourbon and make a batch of the pomegranate ginger punch. Any cocktail preferences from the group?',time:'11:15 AM',own:false},
    ],
    kitchen:[
        {from:'Devon W.',avatar:'DW',color:'var(--sage)',msg:'Running low on green tomatoes. We might not make it through the weekend. Can someone add to the Cahaba Produce order?',time:'9:15 AM',own:false},
        {from:'Maria S.',avatar:'MS',color:'var(--orange)',msg:'Added 30 lbs to the order. Also we need more blue cheese crumbles - down to 4 lbs.',time:'9:22 AM',own:false},
        {from:'Tyler B.',avatar:'TB',color:'var(--blue)',msg:'Prep is done for today. All burger patties formed, slaw made, queso prepped. Fried pickle batter is in the walk-in.',time:'10:30 AM',own:false},
        {from:'Devon W.',avatar:'DW',color:'var(--sage)',msg:'Perfect. Let\'s start experimenting with that smoked brisket taco idea for the spring menu this week.',time:'10:45 AM',own:false},
    ],
    front:[
        {from:'Ashley R.',avatar:'AR',color:'var(--rust)',msg:'Table 12 left a $100 tip on a $60 tab! They said the Pontchartrain Pasta was the best they\'ve ever had.',time:'2:15 PM',own:false},
        {from:'Rachel K.',avatar:'RK',color:'#7c3aed',msg:'That\'s awesome! Also FYI we\'re at a 45 min wait right now. I\'m quoting 30-40 for the patio.',time:'6:30 PM',own:false},
        {from:'Chris N.',avatar:'CN',color:'var(--sage)',msg:'Can someone help run food? I\'m slammed in my section.',time:'7:10 PM',own:false},
    ],
    menu:[
        {from:'Devon W.',avatar:'DW',color:'var(--sage)',msg:'What do y\'all think about a smoked brisket street taco for the spring menu? Pickled onions, cilantro lime crema, on mini flour tortillas.',time:'Yesterday',own:false},
        {from:'Jake M.',avatar:'JM',color:'var(--gold)',msg:'That sounds fire. I could pair it with a new mezcal cocktail - smoky paloma with grapefruit.',time:'Yesterday',own:false},
        {from:'Marcus T.',avatar:'MT',color:'var(--rust)',msg:'Love both ideas. Let\'s do a tasting next Tuesday after close. Devon prep the tacos, Jake make the cocktail. Everyone come hungry.',time:'Yesterday',own:true},
        {from:'Ashley R.',avatar:'AR',color:'var(--rust)',msg:'Can we also try a Nashville hot fish sandwich? Customers keep asking for a spicy fish option.',time:'Today',own:false},
        {from:'Maria S.',avatar:'MS',color:'var(--orange)',msg:'Ooh yes! We could do blackened grouper with the Nashville hot sauce. On Texas toast with slaw.',time:'Today',own:false},
    ],
    announce:[
        {from:'Marcus T.',avatar:'MT',color:'var(--rust)',msg:'TEAM UPDATE: We hit our best January sales numbers EVER this month. $127K in revenue. You all killed it. Drinks on me after close Saturday.',time:'Today',own:true},
        {from:'Marcus T.',avatar:'MT',color:'var(--rust)',msg:'Also - 20th anniversary merch is selling fast. If you want a t-shirt, grab one this week before they\'re gone.',time:'Today',own:true},
    ]
};
let currentChannel='general';

function switchChannel(ch,btn){currentChannel=ch;renderChat();btn.parentElement.querySelectorAll('.channel-btn').forEach(b=>b.classList.remove('active'));btn.classList.add('active')}

function renderChat(){
    const msgs=chatData[currentChannel]||[];
    document.getElementById('chatMessages').innerHTML=msgs.map(m=>`<div class="chat-msg${m.own?' own':''}"><div class="chat-avatar" style="background:${m.color}">${m.avatar}</div><div><div class="chat-name">${m.from}</div><div class="chat-bubble">${m.msg}</div><div class="chat-time">${m.time}</div></div></div>`).join('');
    const el=document.getElementById('chatMessages');el.scrollTop=el.scrollHeight;
}

function sendChat(){
    const input=document.getElementById('chatInput');const msg=input.value.trim();if(!msg)return;
    chatData[currentChannel].push({from:'Marcus T.',avatar:'MT',color:'var(--rust)',msg,time:'Just now',own:true});
    input.value='';renderChat();
}

// ===== DAILY SPECIALS =====
const specials=[
    {name:'Blackened Catfish',price:'$16',desc:'Pan-seared with cajun butter, served over cheese grits with braised collards'},
    {name:'Smoked Brisket Tacos',price:'$14',desc:'3 flour tortillas, pickled red onion, cilantro-lime crema, cotija cheese'},
    {name:'Peach Bourbon Old Fashioned',price:'$12',desc:'Woodford Reserve, house peach syrup, Angostura, smoked orange peel'},
];
const eightySixed=[
    {item:'Grouper',reason:'Vendor short - back tomorrow'},
    {item:'Fried Pickles',reason:'Out of pickle spears'},
];

function renderSpecials(){
    document.getElementById('specialsDate').textContent=today.toLocaleDateString('en-US',{weekday:'long',month:'long',day:'numeric',year:'numeric'});
    document.getElementById('specialsList').innerHTML=specials.map((s,i)=>`<div style="display:flex;justify-content:space-between;align-items:flex-start;padding:12px 16px;background:var(--sage-light);border-radius:10px;border-left:3px solid var(--sage)"><div><strong style="color:var(--ink)">${s.name}</strong> <span style="color:var(--sage);font-weight:700">${s.price}</span><p style="font-size:.82rem;color:var(--g500);margin-top:2px">${s.desc}</p></div><button class="btn btn-outline btn-sm" onclick="specials.splice(${i},1);renderSpecials()" style="flex-shrink:0">Remove</button></div>`).join('');
    document.getElementById('eightySixList').innerHTML=eightySixed.map((e,i)=>`<div style="display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:var(--red-l);border-radius:10px;border-left:3px solid var(--red)"><div><strong style="color:var(--red)">${e.item}</strong><p style="font-size:.82rem;color:var(--g500);margin-top:2px">${e.reason}</p></div><button class="btn btn-outline btn-sm" onclick="eightySixed.splice(${i},1);renderSpecials()" style="flex-shrink:0">Back In</button></div>`).join('');
}
function addSpecial(){const n=document.getElementById('newSpecialName').value.trim(),p=document.getElementById('newSpecialPrice').value.trim(),d=document.getElementById('newSpecialDesc').value.trim();if(!n)return;specials.push({name:n,price:p||'Market',desc:d});document.getElementById('newSpecialName').value='';document.getElementById('newSpecialPrice').value='';document.getElementById('newSpecialDesc').value='';renderSpecials();showToast('Special added!','success')}
function add86(){const n=document.getElementById('new86Item').value.trim(),r=document.getElementById('new86Reason').value.trim();if(!n)return;eightySixed.push({item:n,reason:r||'Out of stock'});document.getElementById('new86Item').value='';document.getElementById('new86Reason').value='';renderSpecials();showToast('86\'d item added','success')}
function notifySpecials(){const items=specials.map(s=>s.name+' ('+s.price+') - '+s.desc).join('\n');const out=eightySixed.map(e=>e.item+' - '+e.reason).join('\n');const subj=encodeURIComponent('Today\'s Specials & 86\'d - '+today.toLocaleDateString());const body=encodeURIComponent('Team,\n\nTODAY\'S SPECIALS:\n'+items+'\n\n86\'d ITEMS:\n'+(out||'None')+'\n\n-'+BIZ);window.open('mailto:?subject='+subj+'&body='+body,'_self');showToast('Specials notification opened','success')}

// ===== AVAILABILITY =====
const availability=[
    {staff:'Rachel Kim',days:['Any','Any','Off','Any','Any','Lunch','Off']},
    {staff:'Devon Williams',days:['Any','Any','Any','Any','Any','Any','Off']},
    {staff:'Ashley Rodriguez',days:['Lunch','Any','Any','Dinner','Any','Any','Off']},
    {staff:'Jake Mitchell',days:['Off','Dinner','Dinner','Dinner','Any','Any','Any']},
    {staff:'Maria Santos',days:['Any','Any','Off','Any','Any','Lunch','Off']},
    {staff:'Tyler Brooks',days:['Any','Any','Any','Off','Any','Lunch','Off']},
    {staff:'Jasmine Cooper',days:['Dinner','Off','Any','Dinner','Any','Any','Off']},
    {staff:'Chris Nguyen',days:['Off','Any','Any','Any','Dinner','Any','Off']},
    {staff:'Lauren Hayes',days:['Off','Dinner','Dinner','Off','Any','Any','Any']},
    {staff:'David Park',days:['Any','Any','Any','Any','Any','Off','Off']},
    {staff:'Brittany James',days:['Lunch','Lunch','Off','Off','Lunch','Any','Any']},
    {staff:'Kevin Moore',days:['Any','Any','Off','Any','Any','Any','Off']},
    {staff:'Emily Chen',days:['Off','Any','Any','Any','Dinner','Any','Off']},
];
const timeOff=[
    {staff:'Emily Chen',dates:'Feb 3-5, 2026',reason:'Family wedding',submitted:'Jan 28',status:'Approved'},
    {staff:'Chris Nguyen',dates:'Feb 14, 2026',reason:'Personal',submitted:'Jan 29',status:'Pending'},
    {staff:'Tyler Brooks',dates:'Feb 20-22, 2026',reason:'Out of town',submitted:'Jan 30',status:'Pending'},
];
function renderAvailability(){
    const dLbl=['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
    document.getElementById('availTableBody').innerHTML=availability.map(a=>`<tr><td style="font-weight:600">${a.staff}</td>${a.days.map(d=>`<td><span class="badge badge-${d==='Off'?'off':d==='Any'?'confirmed':d==='Lunch'?'scheduled':'pending'}">${d}</span></td>`).join('')}</tr>`).join('');
    document.getElementById('timeOffBody').innerHTML=timeOff.map((t,i)=>`<tr><td style="font-weight:600">${t.staff}</td><td>${t.dates}</td><td>${t.reason}</td><td>${t.submitted}</td><td><span class="badge badge-${t.status==='Approved'?'confirmed':'pending'}">${t.status}</span></td><td>${t.status==='Pending'?'<div class="btn-group"><button class="btn btn-green btn-sm" onclick="timeOff['+i+'].status=\'Approved\';renderAvailability();showToast(\'Approved\',\'success\')">Approve</button><button class="btn btn-outline btn-sm" onclick="timeOff['+i+'].status=\'Denied\';renderAvailability();showToast(\'Denied\')">Deny</button></div>':''}</td></tr>`).join('');
}
function submitAvail(){const staff=document.getElementById('avStaff').value;const days=['Mon','Tue','Wed','Thu','Fri','Sat','Sun'].map(d=>document.getElementById('av'+d).value);const existing=availability.find(a=>a.staff===staff);if(existing)existing.days=days;else availability.push({staff,days});renderAvailability();closeModal('availModal');showToast(staff+'\'s availability updated!','success')}

// ===== SHIFT NOTES =====
const handoffNotes={today:[
    {from:'Marcus Thompson (GM)',cat:'Reservations',text:'Table 12 reserved for party of 10 at 7pm. They want the patio section. Birthday celebration - bring candle for dessert.',priority:'Important',time:'11:30 AM'},
    {from:'Devon Williams (Chef)',cat:'86\'d Items',text:'86 the grouper - vendor was short today. Subbing blackened catfish as the fish special. Fried pickles also 86\'d until tomorrow.',priority:'Urgent',time:'10:15 AM'},
    {from:'Rachel Kim (Lead Host)',cat:'General',text:'VIP guest Mr. Henderson (regular) coming in at 6:30. Prefers booth 4. Comp his first drink per Marcus.',priority:'Normal',time:'3:45 PM'},
    {from:'Ashley Rodriguez (Lead Server)',cat:'Prep Notes',text:'Side station 2 needs restocking - low on ramekins, extra napkins, and silverware wraps. Bus tub by dish pit is full.',priority:'Normal',time:'4:00 PM'},
],yesterday:[
    {from:'Jake Mitchell (Bartender)',cat:'Equipment',text:'Ice machine on bar side making a grinding noise. Still working but sounds like it needs a look.',priority:'Important',time:'9:30 PM'},
    {from:'Devon Williams (Chef)',cat:'Prep Notes',text:'All brunch prep done for Saturday. Pancake batter, hollandaise base, and biscuit dough in walk-in. 86\'d nothing - full stock.',priority:'Normal',time:'10:00 PM'},
]};
let handoffTab='today';
function switchHandoffTab(t,el){handoffTab=t;el.parentElement.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));el.classList.add('active');renderHandoff()}
function renderHandoff(){
    const notes=handoffNotes[handoffTab]||[];
    document.getElementById('handoffNotes').innerHTML=notes.map(n=>{
        const pColor=n.priority==='Urgent'?'var(--red)':n.priority==='Important'?'var(--orange)':'var(--sage)';
        const pBg=n.priority==='Urgent'?'var(--red-l)':n.priority==='Important'?'var(--orange-l)':'var(--sage-light)';
        return`<div class="card"><div class="card-body" style="padding:16px"><div style="display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px"><div style="display:flex;align-items:center;gap:10px"><strong style="font-size:.9rem">${n.from}</strong><span class="badge" style="background:${pBg};color:${pColor}">${n.priority}</span><span class="badge badge-off">${n.cat}</span></div><span style="font-size:.78rem;color:var(--g400)">${n.time}</span></div><p style="font-size:.9rem;color:var(--g600);line-height:1.6">${n.text}</p></div></div>`;
    }).join('');
}
function addHandoffNote(){const text=document.getElementById('noteText').value.trim();if(!text)return;const from=document.getElementById('noteFrom').value;const cat=document.getElementById('noteCat').value;const priority=document.getElementById('notePriority').value;handoffNotes.today.unshift({from,cat,text,priority,time:new Date().toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit'})});document.getElementById('noteText').value='';renderHandoff();closeModal('noteModal');showToast('Note posted!','success')}

// ===== SALES =====
const salesLog=[
    {day:'Mon',rev:3850,covers:128},{day:'Tue',rev:4120,covers:137},{day:'Wed',rev:3640,covers:121},
    {day:'Thu',rev:4280,covers:142},{day:'Fri',rev:5890,covers:196},{day:'Sat',rev:6670,covers:222},{day:'Sun',rev:0,covers:0}
];
function renderSales(){
    const max=Math.max(...salesLog.map(s=>s.rev));
    document.getElementById('salesBars').innerHTML=salesLog.map(s=>{
        const pct=max?Math.round((s.rev/max)*100):0;
        const isToday=s.day===DAYS[today.getDay()].substring(0,3);
        return`<div style="display:flex;align-items:center;gap:12px"><span style="font-size:.82rem;font-weight:600;color:var(--g600);min-width:36px">${s.day}</span><div style="flex:1;height:28px;background:var(--g100);border-radius:6px;overflow:hidden"><div style="height:100%;width:${pct}%;background:${isToday?'var(--rust)':'var(--sage)'};border-radius:6px;transition:width .5s"></div></div><span style="font-size:.82rem;font-weight:600;min-width:60px;text-align:right">${s.rev?'$'+s.rev.toLocaleString():'-'}</span></div>`;
    }).join('');
}
function logSale(){const rev=parseFloat(document.getElementById('salesRev').value);const covers=parseInt(document.getElementById('salesCovers').value);if(!rev)return;showToast('Sale logged: $'+rev.toLocaleString()+' / '+covers+' covers','success');document.getElementById('salesRev').value='';document.getElementById('salesCovers').value=''}

// ===== MENU COSTING =====
const menuCosts=[
    {name:'American Animal Burger',price:15,cost:4.20},{name:'Smoked Wings (10)',price:14,cost:4.90},
    {name:'Pontchartrain Pasta',price:18,cost:5.40},{name:'Shrimp & Grits',price:16,cost:5.80},
    {name:'Fried Green Tomatoes',price:11,cost:2.20},{name:'Black & Blue Ribeye',price:38,cost:14.50},
    {name:'Classic Cheeseburger',price:13,cost:3.50},{name:'Tablitas Skirt Steak',price:22,cost:8.80},
    {name:'Nashville Hot Chicken Sandwich',price:14,cost:3.90},{name:'House Salad',price:9,cost:1.80},
    {name:'Pomegranate Ginger Punch',price:11,cost:2.10},{name:'Bourbon Old Fashioned',price:12,cost:2.80},
];
function renderCosting(){
    document.getElementById('costingBody').innerHTML=menuCosts.map(m=>{
        const pct=Math.round((m.cost/m.price)*100);const profit=m.price-m.cost;
        const badge=pct<=25?'badge-confirmed':pct<=32?'badge-ok':pct<=40?'badge-pending':'badge-low';
        const label=pct<=25?'Excellent':pct<=32?'Good':pct<=40?'Watch':'Over Target';
        return`<tr><td style="font-weight:600">${m.name}</td><td>$${m.price.toFixed(2)}</td><td>$${m.cost.toFixed(2)}</td><td><span class="badge ${badge}">${pct}%</span></td><td style="font-weight:600;color:var(--green)">$${profit.toFixed(2)}</td><td style="font-size:.8rem;color:var(--g500)">${label}</td></tr>`;
    }).join('');
}
function addCostIngLine(){const c=document.getElementById('costIngredients'),r=document.createElement('div');r.className='form-row-3 cost-ing-line';r.innerHTML='<div class="form-group"><label>Ingredient</label><input type="text" placeholder="e.g. Bun"></div><div class="form-group"><label>Cost ($)</label><input type="number" step="0.01" placeholder="0.50"></div><div class="form-group"><label></label></div>';c.appendChild(r)}
function addCostItem(){const name=document.getElementById('costName').value.trim();const price=parseFloat(document.getElementById('costPrice').value);if(!name||!price)return;let cost=0;document.querySelectorAll('#costIngredients .cost-ing-line').forEach(r=>{cost+=parseFloat(r.querySelectorAll('input')[1].value)||0});menuCosts.unshift({name,price,cost});renderCosting();closeModal('costModal');showToast('Menu item added!','success')}

// ===== HEALTH & SAFETY =====
const openingChecks=['Walk-in cooler temp check (below 40Â°F)','Freezer temp check (below 0Â°F)','Prep station sanitized','Hand wash stations stocked (soap, towels)','Floor mats clean and in place','All burners and ovens functional','Fryer oil level and temp check','Ice bins filled','Restrooms stocked and clean','Front door unlocked, signage on','POS system booted and tested','Music/TV on'];
const closingChecks=['All food stored and labeled with date','Walk-in organized, FIFO checked','Grill and flattop cleaned','Fryers filtered and covered','Prep surfaces sanitized','Floors swept and mopped','Trash taken to dumpster','Dish pit empty and clean','Bar mats washed, bottles wiped','Doors locked, alarm set','Safe counted, deposit prepared','All lights off except security'];
const checkState={open:{},close:{}};

function renderSafetyChecklist(type,items,containerId){
    const state=checkState[type];
    document.getElementById(containerId).innerHTML=items.map((item,i)=>{
        const checked=state[i]||false;
        return`<div style="display:flex;align-items:center;gap:12px;padding:10px 0;border-bottom:1px solid var(--g100);cursor:pointer" onclick="checkState.${type}[${i}]=!checkState.${type}[${i}];renderSafety()"><div style="width:22px;height:22px;border-radius:6px;border:2px solid ${checked?'var(--green)':'var(--g300)'};background:${checked?'var(--green)':'transparent'};display:flex;align-items:center;justify-content:center;flex-shrink:0">${checked?'<svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3"><polyline points="20 6 9 17 4 12"/></svg>':''}</div><span style="font-size:.9rem;${checked?'text-decoration:line-through;color:var(--g400)':'color:var(--g700)'}">${item}</span></div>`;
    }).join('')+`<div style="margin-top:16px;display:flex;align-items:center;gap:12px"><span style="font-size:.85rem;font-weight:600;color:var(--g600)">${Object.values(state).filter(Boolean).length} of ${items.length} completed</span><div style="flex:1;height:6px;background:var(--g200);border-radius:3px"><div style="height:100%;width:${Math.round(Object.values(state).filter(Boolean).length/items.length*100)}%;background:var(--green);border-radius:3px;transition:width .3s"></div></div></div>`;
}

const tempLog=[
    {equip:'Walk-in Cooler',temp:38,range:'33-40Â°F',time:'6:00 AM',by:'Tyler B.',ok:true},
    {equip:'Freezer',temp:-2,range:'Below 0Â°F',time:'6:00 AM',by:'Tyler B.',ok:true},
    {equip:'Prep Line Cooler',temp:39,range:'33-40Â°F',time:'6:05 AM',by:'Tyler B.',ok:true},
    {equip:'Fryer Oil',temp:350,range:'325-375Â°F',time:'10:30 AM',by:'Maria S.',ok:true},
    {equip:'Dish Machine Final Rinse',temp:180,range:'Above 170Â°F',time:'10:45 AM',by:'David P.',ok:true},
];
function renderTempLog(){
    document.getElementById('tempLogBody').innerHTML=tempLog.map(t=>`<tr><td style="font-weight:600">${t.equip}</td><td>${t.temp}Â°F</td><td style="font-size:.82rem;color:var(--g500)">${t.range}</td><td>${t.time}</td><td>${t.by}</td><td><span class="badge badge-${t.ok?'confirmed':'low'}">${t.ok?'Pass':'Fail'}</span></td></tr>`).join('');
}
function addTempRow(){tempLog.push({equip:'Walk-in Cooler',temp:38,range:'33-40Â°F',time:new Date().toLocaleTimeString('en-US',{hour:'numeric',minute:'2-digit'}),by:'Marcus T.',ok:true});renderTempLog();showToast('Temp logged','success')}

function renderSafety(){
    document.getElementById('safetyDateOpen').textContent=document.getElementById('safetyDateClose').textContent=today.toLocaleDateString('en-US',{weekday:'long',month:'long',day:'numeric'});
    renderSafetyChecklist('open',openingChecks,'openChecklist');
    renderSafetyChecklist('close',closingChecks,'closeChecklist');
    renderTempLog();
}
function switchSafetyTab(t,el){['open','close','temps'].forEach(x=>document.getElementById('safetyTab-'+x).style.display=x===t?'block':'none');el.parentElement.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));el.classList.add('active')}

// ===== DOCUMENTS =====
const trainingDocs=[
    {title:'New Hire Orientation Guide',desc:'Everything new staff need to know - dress code, policies, POS basics, menu overview',cat:'Onboarding',updated:'Jan 15, 2026'},
    {title:'Server Training Manual',desc:'Table numbers, section assignments, upselling tips, wine knowledge, allergy protocols',cat:'Front of House',updated:'Jan 10, 2026'},
    {title:'Bartender Cocktail Specs',desc:'All house cocktails with exact measurements, garnishes, and glassware',cat:'Bar',updated:'Jan 22, 2026'},
    {title:'Host & Seating Guide',desc:'Reservation system, wait list management, table turn times, VIP handling',cat:'Front of House',updated:'Dec 18, 2025'},
    {title:'Food Safety & Allergen Guide',desc:'Common allergens on our menu, cross-contamination prevention, emergency procedures',cat:'Safety',updated:'Jan 5, 2026'},
];
const recipeDocs=[
    {title:'Smoked Wings Recipe',desc:'Dry rub blend, smoking time/temp, sauce variations (Alabama White, Nashville Hot, Classic BBQ)',cat:'Kitchen',updated:'Jan 20, 2026'},
    {title:'Burger Specs & Temps',desc:'Patty weight, cooking temps by doneness, toasting protocol, build order for all burgers',cat:'Kitchen',updated:'Jan 18, 2026'},
    {title:'Cocktail Recipe Book',desc:'Full specs for all 24 cocktails - Pomegranate Ginger Punch, Bourbon Old Fashioned, Mudtown Mule, etc.',cat:'Bar',updated:'Jan 22, 2026'},
    {title:'Brunch Menu Prep Guide',desc:'Saturday & Sunday brunch recipes - pancakes, eggs benedict, biscuits & gravy, French toast',cat:'Kitchen',updated:'Jan 12, 2026'},
    {title:'Sauce & Dressing Recipes',desc:'House ranch, blue cheese, cajun remoulade, honey mustard, vinaigrettes',cat:'Kitchen',updated:'Dec 20, 2025'},
];
const policyDocs=[
    {title:'Employee Handbook',desc:'PTO policy, scheduling rules, dress code, code of conduct, disciplinary procedures',cat:'HR',updated:'Jan 1, 2026'},
    {title:'Health Department Standards',desc:'Alabama ADPH requirements, inspection prep checklist, critical violations to avoid',cat:'Compliance',updated:'Dec 15, 2025'},
    {title:'Emergency Procedures',desc:'Fire evacuation, severe weather, medical emergency, robbery protocol, emergency contacts',cat:'Safety',updated:'Nov 30, 2025'},
    {title:'Social Media Guidelines',desc:'What staff can/can\'t post, photo policy, responding to online reviews',cat:'Marketing',updated:'Jan 8, 2026'},
];
function renderDocs(){
    [['trainingDocs',trainingDocs],['recipeDocs',recipeDocs],['policyDocs',policyDocs]].forEach(([id,docs])=>{
        document.getElementById(id).innerHTML=docs.map(d=>`<div class="card" style="margin-bottom:12px"><div class="card-body" style="padding:16px;display:flex;justify-content:space-between;align-items:center"><div><div style="display:flex;align-items:center;gap:10px;margin-bottom:4px"><strong style="font-size:.9rem">${d.title}</strong><span class="badge badge-off">${d.cat}</span></div><p style="font-size:.82rem;color:var(--g500)">${d.desc}</p><span style="font-size:.72rem;color:var(--g400)">Updated ${d.updated}</span></div><button class="btn btn-outline btn-sm">View</button></div></div>`).join('');
    });
}
function switchDocsTab(t,el){['training','recipes','policies'].forEach(x=>document.getElementById('docsTab-'+x).style.display=x===t?'block':'none');el.parentElement.querySelectorAll('.tab').forEach(x=>x.classList.remove('active'));el.classList.add('active')}

// ===== DASHBOARD =====
function renderDashboard(){
    const todayStr=dateStr(today);
    const todayShifts=shifts.filter(s=>s.date===todayStr);
    document.getElementById('dashShifts').innerHTML=(todayShifts.length?todayShifts:shifts.slice(0,6)).map(s=>{
        const[start,end]=s.time.split('-');
        return`<div style="display:flex;align-items:center;gap:12px;padding:10px 14px;background:var(--g50);border-radius:8px;border-left:3px solid ${s.role==='Kitchen'?'var(--sage)':s.role==='Bar'?'var(--gold)':s.role==='Host'?'#7c3aed':'var(--rust)'}"><span style="font-size:.82rem;font-weight:600;color:var(--g600);min-width:100px">${fmtTime(start)} - ${fmtTime(end)}</span><span class="sched-chip ${ROLES[s.role]||'chip-server'}" style="padding:3px 8px;border-radius:5px">${s.role}</span><span style="font-size:.875rem;font-weight:600">${s.staff}</span></div>`;
    }).join('');

    const lowStock=inventory.filter(i=>(i.stock/i.par)<=0.4).slice(0,4);
    document.getElementById('dashLowStock').innerHTML=lowStock.map(i=>{
        const pct=Math.round((i.stock/i.par)*100);
        return`<tr><td style="font-weight:600">${i.item}</td><td>${i.stock}/${i.par} ${i.unit}</td><td><span class="badge badge-low">Low (${pct}%)</span></td></tr>`;
    }).join('');

    const recentMsgs=chatData.general.slice(-3);
    document.getElementById('dashMessages').innerHTML=recentMsgs.map(m=>`<div style="display:flex;gap:10px;padding:8px 0;border-bottom:1px solid var(--g100)"><div class="chat-avatar" style="background:${m.color};width:28px;height:28px;font-size:.65rem">${m.avatar}</div><div><span style="font-size:.8rem;font-weight:600">${m.from}</span> <span style="font-size:.78rem;color:var(--g400)">${m.time}</span><p style="font-size:.85rem;color:var(--g600);margin-top:2px">${m.msg.substring(0,120)}${m.msg.length>120?'...':''}</p></div></div>`).join('');
}

// ===== INIT =====
renderDashboard();renderSpecials();renderScheduleGrid();renderShiftTable();renderAvailability();renderHandoff();renderStock();renderPO();renderCatering();renderSales();renderCosting();renderChat();renderSafety();renderDocs();
try{document.getElementById('shDate').valueAsDate=new Date();document.getElementById('poDate').valueAsDate=new Date(Date.now()+2*86400000)}catch(e){}
document.querySelectorAll('.modal-overlay').forEach(m=>{m.addEventListener('click',e=>{if(e.target===m)m.classList.remove('open')})});
</script>
</body>
</html>
